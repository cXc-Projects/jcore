(function(a){a.fn.nivoZoom=function(m){function l(g,b,f){var c=a("img.nivoLarge",b);b.hasClass("zoomed")?(d.overlay&&a("#nivoOverlay").fadeOut(d.speed/2),a(".nivoCaption",b).length>0&&a(".nivoCaption",b).fadeOut(d.speed/2),c.fadeOut(d.speed/2,function(){g.animate({opacity:1},d.speed/2)}),b.removeClass("zoomed")):(d.overlay&&a("#nivoOverlay").fadeIn(d.speed/2),f.css("opacity","0"),g.animate({opacity:0},d.speed/2,function(){c.fadeIn(d.speed/2,function(){if(a(".nivoCaption",b).length>0){var e=a(".nivoCaption:first",
b);if(!e.hasClass("nivo-processed")){var f=g.width();f==0&&(f=g.attr("width"));var i=g.height();i==0&&(i=g.attr("height"));var h=c.width();h==0&&(h=c.attr("width"));var j=c.height();j==0&&(j=c.attr("height"));e.css({width:h,opacity:d.captionOpacity});b.hasClass("topRight")?e.css({top:j-e.outerHeight()+"px",right:"0px"}):b.hasClass("bottomRight")?e.css({bottom:"0px",right:"0px"}):b.hasClass("bottomLeft")?e.css({bottom:"0px",left:"0px"}):b.hasClass("center")?e.css({top:Math.ceil(i/2-j/2)+(j-e.outerHeight())+
"px",left:f/2-h/2+"px"}):e.css({top:j-e.outerHeight()+"px",left:"0px"});e.addClass("nivo-processed")}e.fadeIn(d.speed/2)}})}),b.addClass("zoomed"))}function n(d,b,f){var c=new Image;a(c).load(function(){a(this).addClass("nivoLarge");a(this).css({position:"absolute",display:"none","z-index":99});navigator.userAgent.match(/MSIE \d\.\d+/)&&b.css("z-index","100");if(b.hasClass("topRight"))a(this).css({top:"0px",right:"0px"});else if(b.hasClass("bottomRight"))a(this).css({bottom:"0px",right:"0px"});else if(b.hasClass("bottomLeft"))a(this).css({bottom:"0px",
left:"0px"});else if(b.hasClass("center")){var c=d.width();c==0&&(c=d.attr("width"));var k=d.height();k==0&&(k=d.attr("height"));var i=a(this).width();i==0&&(i=a(this).attr("width"));var h=a(this).height();h==0&&(h=a(this).attr("height"));a(this).css({top:k/2-h/2+"px",left:c/2-i/2+"px"})}else a(this).css({top:"0px",left:"0px"});a(this).attr("title","Click to close");b.append(a(this));f.call(this)}).attr("src",b.attr("href"))}var d=a.extend({},a.fn.nivoZoom.defaults,m);d.overlay&&!(a.browser.msie&&
a.browser.version.substr(0,1)<8)&&(a("body").prepend('<div id="nivoOverlay" />'),a("#nivoOverlay").css({position:"fixed",top:0,left:0,width:"100%",height:"100%",background:d.overlayColor,opacity:d.overlayOpacity,"z-index":90,display:"none"}));return this.each(function(){var g=a(this);a("a.nivoZoom",g).each(function(){var b=a(this);if(b.is("a")){var f=a(this).find("img:first");b.css({position:"relative",display:"inline-block"});b.attr("title","Click to zoom");b.append('<div class="nivoZoomHover" />');
var c=a(".nivoZoomHover",b);c.css("opacity","0");b.hover(function(){b.hasClass("zoomed")||c.stop().animate({opacity:d.zoomHoverOpacity},300)},function(){c.hasClass("loading")||c.stop().animate({opacity:0},300)});b.bind("click",function(){a("img.nivoLarge",b).length==0?(c.addClass("loading"),n(f,b,function(){c.removeClass("loading");l(f,b,c)})):l(f,b,c);return!1})}})})};a.fn.nivoZoom.defaults={speed:500,zoomHoverOpacity:0.8,overlay:!1,overlayColor:"#333",overlayOpacity:0.5,captionOpacity:0.8}})(jQuery);
