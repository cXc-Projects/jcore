(function(e){e.widget("ui.selectable",e.ui.mouse,{options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch"},_create:function(){var b=this;this.element.addClass("ui-selectable");this.dragged=false;var f;this.refresh=function(){f=e(b.options.filter,b.element[0]);f.each(function(){var b=e(this),c=b.offset();e.data(this,"selectable-item",{element:this,$element:b,left:c.left,top:c.top,right:c.left+b.outerWidth(),bottom:c.top+b.outerHeight(),startselected:false,selected:b.hasClass("ui-selected"),
selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})};this.refresh();this.selectees=f.addClass("ui-selectee");this._mouseInit();this.helper=e("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(b){var f=this;this.opos=[b.pageX,
b.pageY];if(!this.options.disabled){var d=this.options;this.selectees=e(d.filter,this.element[0]);this._trigger("start",b);e(d.appendTo).append(this.helper);this.helper.css({left:b.clientX,top:b.clientY,width:0,height:0});d.autoRefresh&&this.refresh();this.selectees.filter(".ui-selected").each(function(){var c=e.data(this,"selectable-item");c.startselected=true;if(!b.metaKey)c.$element.removeClass("ui-selected"),c.selected=false,c.$element.addClass("ui-unselecting"),c.unselecting=true,f._trigger("unselecting",
b,{unselecting:c.element})});e(b.target).parents().andSelf().each(function(){var c=e.data(this,"selectable-item");if(c){var d=!b.metaKey||!c.$element.hasClass("ui-selected");c.$element.removeClass(d?"ui-unselecting":"ui-selected").addClass(d?"ui-selecting":"ui-unselecting");c.unselecting=!d;c.selecting=d;(c.selected=d)?f._trigger("selecting",b,{selecting:c.element}):f._trigger("unselecting",b,{unselecting:c.element});return false}})}},_mouseDrag:function(b){var f=this;this.dragged=true;if(!this.options.disabled){var d=
this.options,c=this.opos[0],g=this.opos[1],i=b.pageX,j=b.pageY;if(c>i)var h=i,i=c,c=h;g>j&&(h=j,j=g,g=h);this.helper.css({left:c,top:g,width:i-c,height:j-g});this.selectees.each(function(){var a=e.data(this,"selectable-item");if(a&&a.element!=f.element[0]){var h=false;d.tolerance=="touch"?h=!(a.left>i||a.right<c||a.top>j||a.bottom<g):d.tolerance=="fit"&&(h=a.left>c&&a.right<i&&a.top>g&&a.bottom<j);if(h){if(a.selected)a.$element.removeClass("ui-selected"),a.selected=false;if(a.unselecting)a.$element.removeClass("ui-unselecting"),
a.unselecting=false;if(!a.selecting)a.$element.addClass("ui-selecting"),a.selecting=true,f._trigger("selecting",b,{selecting:a.element})}else{if(a.selecting)if(b.metaKey&&a.startselected)a.$element.removeClass("ui-selecting"),a.selecting=false,a.$element.addClass("ui-selected"),a.selected=true;else{a.$element.removeClass("ui-selecting");a.selecting=false;if(a.startselected)a.$element.addClass("ui-unselecting"),a.unselecting=true;f._trigger("unselecting",b,{unselecting:a.element})}if(a.selected&&!b.metaKey&&
!a.startselected)a.$element.removeClass("ui-selected"),a.selected=false,a.$element.addClass("ui-unselecting"),a.unselecting=true,f._trigger("unselecting",b,{unselecting:a.element})}}});return false}},_mouseStop:function(b){var f=this;this.dragged=false;e(".ui-unselecting",this.element[0]).each(function(){var d=e.data(this,"selectable-item");d.$element.removeClass("ui-unselecting");d.unselecting=false;d.startselected=false;f._trigger("unselected",b,{unselected:d.element})});e(".ui-selecting",this.element[0]).each(function(){var d=
e.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected");d.selecting=false;d.selected=true;d.startselected=true;f._trigger("selected",b,{selected:d.element})});this._trigger("stop",b);this.helper.remove();return false}});e.extend(e.ui.selectable,{version:"@VERSION"})})(jQuery);
