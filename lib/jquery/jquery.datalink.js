(function(e,l){function k(a){var a=e.data(a),b;return(a._getLinks||(b={s:[],t:[]},a._getLinks=function(){return b}))()}function m(a,b,e){b.bind(a.nodeType?"change":j,e)}function g(a,e,f){e.unbind(a.nodeType?"change":j,f)}function n(a,b,f,d){var c=a.target,h=a.type===j,i;h?a.namespace&&(b+="."+a.namespace):b=c.name||c.id;if(d){i=d[b];if(!i)return null;a=i.name;i=i.convert;typeof i==="string"&&(i=e.convertFn[i])}else a=b;return{name:a,convert:i,value:h?f:e(c).val()}}var o=e.cleanData,p={val:"val",html:"html",
text:"text"},j="changeField";e.extend({cleanData:function(a){for(var b=0,f;(f=a[b])!=null;b++){var d=e.data(f,"_getLinks");if(d){var d=d(),c=e(f);e.each(d.s,function(){g(f,c,this.handler);this.handlerRev&&g(this.target,e(this.target),this.handlerRev)});e.each(d.t,function(){g(this.source,e(this.source),this.handler);this.handlerRev&&g(f,c,this.handlerRev)});d.s=[];d.t=[]}}o(a)},convertFn:{"!":function(a){return!a}},setField:function(a,b,f){if(a.nodeType)b=p[b]||"attr",e(a)[b](f);else{var d=b.split(".");
d[1]=d[1]?"."+d[1]:"";var c=e(a),h=[d[0],f];c.triggerHandler("setField"+d[1]+"!",h);f!==l&&(a[b]=f);c.triggerHandler(j+d[1]+"!",h)}}});e.extend(e.fn,{link:function(a,b){function f(a){a="[name="+a+"], [id="+a+"]";return d.filter(a).add(d.find(a))}var d=this;if(!a)return d;typeof a==="string"&&(a=e(a,this.context||null)[0]);var c=!b,h,i,g=function(d,b,c){var f=n(d,b,c,h);if(f)b=f.name,c=f.value,(f=f.convert)&&(c=f(c,d.target,a)),c!==l&&e.setField(a,b,c)},j=function(c,d,b){if(c=n(c,d,b,i)){var h=c.value,
g=c.convert;f(c.name).each(function(){b=h;g&&(b=g(b,a,this));b!==l&&e.setField(this,"val",b)})}};b&&e.each(b,function(a,b){var d=b,f,g,j;e.isPlainObject(b)?(d=b.name||a,f=b.convert,g=b.convertBack,j=b.twoWay!==!1,c|=j):c=j=!0;j&&(i=i||{},i[a]={name:d,convert:g});h=h||{};h[d]={name:a,convert:f,twoWay:j}});d.each(function(){m(this,e(this),g);var b={handler:g,handlerRev:c?j:null,target:a,source:this};k(this).s.push(b);a.nodeType&&k(a).t.push(b)});c&&m(a,e(a),j);return d},unlink:function(a){this.each(function(){for(var b=
e(this),f=k(this).s,d=f.length-1;d>=0;d--){var c=f[d];if(c.target===a){g(this,b,c.handler);c.handlerRev&&g(c.target,e(c.target),c.handlerRev);f.splice(d,1);var h=k(c.target).t,c=e.inArray(c,h);c!==-1&&h.splice(c,1)}}})},setField:function(a,b){return this.each(function(){e.setField(this,a,b)})}})})(jQuery);
