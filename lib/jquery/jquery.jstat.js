function jstat(){}j=jstat;
(function(){var a=false,c=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(b){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;a=true;var f=new this;a=false;for(var g in b)f[g]=typeof b[g]=="function"&&typeof e[g]=="function"&&c.test(b[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);this._super=c;return d}}(g,b[g]):b[g];d.prototype=f;d.constructor=d;d.extend=arguments.callee;
return d}})();jstat.ONE_SQRT_2PI=0.3989422804014327;jstat.LN_SQRT_2PI=0.9189385332046728;jstat.LN_SQRT_PId2=0.22579135264472744;jstat.DBL_MIN=2.22507E-308;jstat.DBL_EPSILON=2.220446049250313E-16;jstat.SQRT_32=5.656854249492381;jstat.TWO_PI=6.283185307179586;jstat.DBL_MIN_EXP=-999;jstat.SQRT_2dPI=0.79788456080287;jstat.LN_SQRT_PI=0.5723649429247;jstat.seq=function(a,c,b){return(new Range(a,c,b)).getPoints()};
jstat.dnorm=function(a,c,b,d){c==null&&(c=0);b==null&&(b=1);d==null&&(d=false);c=new NormalDistribution(c,b);if(isNaN(a))if(a.length){for(var b=[],e=0;e<a.length;e++)b.push(c._pdf(a[e],d));return b}else throw"Illegal argument: x";else return c._pdf(a,d)};
jstat.pnorm=function(a,c,b,d,e){c==null&&(c=0);b==null&&(b=1);d==null&&(d=true);e==null&&(e=false);c=new NormalDistribution(c,b);if(isNaN(a))if(a.length){for(var b=[],f=0;f<a.length;f++)b.push(c._cdf(a[f],d,e));return b}else throw"Illegal argument: x";else return c._cdf(a,d,e)};
jstat.dlnorm=function(a,c,b,d){c==null&&(c=0);b==null&&(b=1);d==null&&(d=false);c=new LogNormalDistribution(c,b);if(isNaN(a))if(a.length){for(var b=[],e=0;e<a.length;e++)b.push(c._pdf(a[e],d));return b}else throw"Illegal argument: x";else return c._pdf(a,d)};
jstat.plnorm=function(a,c,b,d,e){c==null&&(c=0);b==null&&(b=1);d==null&&(d=true);e==null&&(e=false);c=new LogNormalDistribution(c,b);if(isNaN(a))if(a.length){for(var b=[],f=0;f<a.length;f++)b.push(c._cdf(a[f],d,e));return b}else throw"Illegal argument: x";else return c._cdf(a,d,e)};jstat.dbeta=function(a,c,b,d,e){e==null&&(e=false);c=new BetaDistribution(c,b);if(isNaN(a))if(a.length){b=[];for(d=0;d<a.length;d++)b.push(c._pdf(a[d],e));return b}else throw"Illegal argument: x";else return c._pdf(a,e)};
jstat.pbeta=function(a,c,b,d,e,f){f==null&&(f=false);e==null&&(e=true);c=new BetaDistribution(c,b);if(isNaN(a))if(a.length){b=[];for(d=0;d<a.length;d++)b.push(c._cdf(a[d],e,f));return b}else throw"Illegal argument: x";else return c._cdf(a,e,f)};jstat.dgamma=function(a,c,b,d,e){b==null&&(b=1);d==null&&(d=1/b);e==null&&(e=false);c=new GammaDistribution(c,d);if(isNaN(a))if(a.length){b=[];for(d=0;d<a.length;d++)b.push(c._pdf(a[d],e));return b}else throw"Illegal argument: x";else return c._pdf(a,e)};
jstat.pgamma=function(a,c,b,d,e,f){b==null&&(b=1);d==null&&(d=1/b);e==null&&(e=true);f==null&&(f=false);c=new GammaDistribution(c,d);if(isNaN(a))if(a.length){b=[];for(d=0;d<a.length;d++)b.push(c._cdf(a[d],e,f));return b}else throw"Illegal argument: x";else return c._cdf(a,e,f)};jstat.dt=function(a,c,b,d){d==null&&(d=false);c=new StudentTDistribution(c,b);if(isNaN(a))if(a.length){for(var b=[],e=0;e<a.length;e++)b.push(c._pdf(a[e],d));return b}else throw"Illegal argument: x";else return c._pdf(a,d)};
jstat.pt=function(a,c,b,d,e){d==null&&(d=true);e==null&&(e=false);c=new StudentTDistribution(c,b);if(isNaN(a))if(a.length){for(var b=[],f=0;f<a.length;f++)b.push(c._cdf(a[f],d,e));return b}else throw"Illegal argument: x";else return c._cdf(a,d,e)};
jstat.plot=function(a,c,b){if(a==null)throw"x is undefined in jstat.plot";if(c==null)throw"y is undefined in jstat.plot";if(a.length!=c.length)throw"x and y lengths differ in jstat.plot";var d={series:{lines:{},points:{}}},e=[];if(a.length==void 0)e.push([a,c]),d.series.points.show=true;else for(var f=0;f<a.length;f++)e.push([a[f],c[f]]);a="jstat graph";if(b!=null){if(b.type!=null)if(b.type=="l")d.series.lines.show=true;else if(b.type=="p")d.series.lines.show=false,d.series.points.show=true;if(b.hover!=
null)d.grid={hoverable:b.hover};if(b.main!=null)a=b.main}var b=new Date,g=b.getMilliseconds()*b.getMinutes()+b.getSeconds();$("body").append('<div title="'+a+'" style="display: none;" id="'+g+'"><div id="graph-'+g+'" style="width:95%; height: 95%"></div></div>');$("#"+g).dialog({modal:false,width:475,height:475,resizable:true,resize:function(){$.plot($("#graph-"+g),[e],d)},open:function(){$.plot($("#graph-"+g),[e],d)}})};jstat.log10=function(a){return Math.log(a)/Math.LN10};
jstat.toSigFig=function(a,c){if(a==0)return 0;var b=Math.ceil(jstat.log10(a<0?-a:a)),b=c-parseInt(b),b=Math.pow(10,b);return Math.round(a*b)/b};jstat.trunc=function(a){return a>0?Math.floor(a):Math.ceil(a)};jstat.isFinite=function(a){return!isNaN(a)&&a!=Number.POSITIVE_INFINITY&&a!=Number.NEGATIVE_INFINITY};
jstat.dopois_raw=function(a,c,b){if(c==0)return a==0?b?0:1:b?Number.NEGATIVE_INFINITY:0;if(!jstat.isFinite(c))return b?Number.NEGATIVE_INFINITY:0;if(a<0)return b?Number.NEGATIVE_INFINITY:0;if(a<=c*jstat.DBL_MIN)return b?-c:Math.exp(-c);if(c<a*jstat.DBL_MIN){var d=-c+a*Math.log(c)-jstat.lgamma(a+1);return b?d:Math.exp(d)}d=jstat.TWO_PI*a;a=-jstat.stirlerr(a)-jstat.bd0(a,c);return b?-0.5*Math.log(d)+a:Math.exp(a)/Math.sqrt(d)};
jstat.bd0=function(a,c){var b,d,e,f,g;if(!jstat.isFinite(a)||!jstat.isFinite(c)||c==0)throw"illegal parameter in jstat.bd0";if(Math.abs(a-c)>0.1*(a+c)){f=(a-c)/(a+c);d=(a-c)*f;b=2*a*f;f*=f;for(g=1;;g++){b*=f;e=d+b/((g<<1)+1);if(e==d)return e;d=e}}return a*Math.log(a/c)+c-a};
jstat.stirlerr=function(a){var c=[0,0.15342640972002736,0.08106146679532726,0.05481412105191765,0.0413406959554093,0.03316287351993629,0.02767792568499834,0.023746163656297496,0.020790672103765093,0.018488450532673187,0.016644691189821193,0.015134973221917378,0.013876128823070748,0.012810465242920227,0.01189670994589177,0.011104559758206917,0.010411265261972096,0.009799416126158804,0.009255462182712733,0.008768700134139386,0.00833056343336287,0.00793411456431402,0.007573675487951841,0.007244554301320383,
0.00694284010720953,0.006665247032707682,0.006408994188004207,0.006171712263039458,0.0059513701127588475,0.0057462165130101155,0.005554733551962801],b;if(a<=15)return b=a+a,b==parseInt(b)?c[parseInt(b)]:jstat.lgamma(a+1)-(a+0.5)*Math.log(a)+a-jstat.LN_SQRT_2PI;b=a*a;return a>500?(0.08333333333333333-0.002777777777777778/b)/a:a>80?(0.08333333333333333-(0.002777777777777778-7.936507936507937E-4/b)/b)/a:a>35?(0.08333333333333333-(0.002777777777777778-(7.936507936507937E-4-5.952380952380953E-4/b)/b)/
b)/a:(0.08333333333333333-(0.002777777777777778-(7.936507936507937E-4-(5.952380952380953E-4-8.417508417508417E-4/b)/b)/b)/b)/a};
jstat.lgamma=function(a){return function(a){var b,d;if(isNaN(a))return a;if(a<=0&&a==jstat.trunc(a))return console.warn("Negative integer argument in lgammafn_sign"),Number.POSITIVE_INFINITY;b=Math.abs(a);if(b<=10)return Math.log(Math.abs(jstat.gamma(a)));if(b>2.5327372760800758E305)return console.warn("Illegal arguement passed to lgammafn_sign"),Number.POSITIVE_INFINITY;if(a>0)return a>1E17?a*(Math.log(a)-1):a>4934720?jstat.LN_SQRT_2PI+(a-0.5)*Math.log(a)-a:jstat.LN_SQRT_2PI+(a-0.5)*Math.log(a)-
a+jstat.lgammacor(a);d=Math.abs(Math.sin(Math.PI*b));if(d==0)throw"Should never happen!!";b=jstat.LN_SQRT_PId2+(a-0.5)*Math.log(b)-a-Math.log(d)-jstat.lgammacor(b);if(Math.abs((a-jstat.trunc(a-0.5))*b/a)<1.4901161193847656E-8)throw"The answer is less than half the precision argument too close to a negative integer";return b}(a,null)};
jstat.gamma=function(a){var c=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],b=[-30.840230011973897,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.25967555349],d=[-0.001910444077728,8.4171387781295E-4,-5.952379913043012E-4,7.936507935003503E-4,-0.0027777777777776816,0.08333333333333333,0.0057083835261],e,f,g,i,h,k,l;f=0;
g=1;e=0;h=a;if(h<=0)if(h=-a,l=jstat.trunc(h),i=h-l,i!=0)l!=jstat.trunc(l*0.5)*2&&(f=1),g=-Math.PI/Math.sin(Math.PI*i),h+=1;else return Number.POSITIVE_INFINITY;if(h<jstat.DBL_EPSILON)if(h>=jstat.DBL_MIN)i=1/h;else return Number.POSITIVE_INFINITY;else if(h<12){l=h;h<1?(k=h,h+=1):(e=parseInt(h)-1,h-=parseFloat(e),k=h-1);i=0;d=1;for(a=0;a<8;++a)i=(i+c[a])*k,d=d*k+b[a];i=i/d+1;if(l<h)i/=l;else if(l>h)for(a=0;a<e;++a)i*=h,h+=1}else if(h<=171.624){b=h*h;c=d[6];for(a=0;a<6;++a)c=c/b+d[a];c=c/h-h+jstat.LN_SQRT_2PI;
c+=(h-0.5)*Math.log(h);i=Math.exp(c)}else return Number.POSITIVE_INFINITY;f&&(i=-i);g!=1&&(i=g/i);return i};
jstat.lgammacor=function(a){var c=[0.16663894804518634,-1.384948176067564E-5,9.81082564692473E-9,-1.809129475572494E-11,6.221098041892606E-14,-3.399615005417722E-16,2.683181998482699E-18,-2.868042435334643E-20,3.9628370610464347E-22,-6.831888753985767E-24,1.4292273559424982E-25,-3.5475981581010704E-27,1.025680058010471E-28,-3.401102254316749E-30,1.276642195630063E-31],b;if(a<10)return Number.NaN;else if(a>=3.745194030963158E306)throw"Underflow error in lgammacor";else if(a<9.490626562425156E7)return b=
10/a,jstat.chebyshev(b*b*2-1,c,5)/a;return 1/(a*12)};
jstat.incompleteBeta=function(a,c,b){function d(a,b,c){var d,e,l,q,n,m,o,r,p;o=a+b;p=a+1;r=a-1;q=1;n=1-o*c/p;Math.abs(n)<1.0E-30&&(n=1.0E-30);m=n=1/n;for(d=1;d<=100;d++)if(e=2*d,l=d*(b-d)*c/((r+e)*(a+e)),n=1+l*n,Math.abs(n)<1.0E-30&&(n=1.0E-30),q=1+l/q,Math.abs(q)<1.0E-30&&(q=1.0E-30),n=1/n,m*=n*q,l=-(a+d)*(o+d)*c/((a+e)*(p+e)),n=1+l*n,Math.abs(n)<1.0E-30&&(n=1.0E-30),q=1+l/q,Math.abs(q)<1.0E-30&&(q=1.0E-30),n=1/n,e=n*q,m*=e,Math.abs(e-1)<3.0E-12)break;if(d>100)return console.warn("a or b too big, or MAXIT too small in betacf: "+
a+", "+b+", "+c+", "+m),m;isNaN(m)&&console.warn(a+", "+b+", "+c);return m}var e;if(b<0||b>1)throw"bad x in routine incompleteBeta";e=b==0||b==1?0:Math.exp(jstat.lgamma(a+c)-jstat.lgamma(a)-jstat.lgamma(c)+a*Math.log(b)+c*Math.log(1-b));return b<(a+1)/(a+c+2)?e*d(a,c,b)/a:1-e*d(c,a,1-b)/c};jstat.chebyshev=function(a,c,b){var d,e,f,g;if(b<1||b>1E3)return Number.NaN;if(a<-1.1||a>1.1)return Number.NaN;f=a*2;a=e=d=0;for(g=1;g<=b;g++)e=d,d=a,a=f*d-e+c[b-g];return(a-e)*0.5};
jstat.fmin2=function(a,c){return a<c?a:c};jstat.log1p=function(a){var c=0;if(a<=-1)return Number.NEGATIVE_INFINITY;if(a<0||a>1)return Math.log(1+a);for(var b=1;b<50;b++)b%2===0?c-=Math.pow(a,b)/b:c+=Math.pow(a,b)/b;return c};jstat.expm1=function(a){var c;c=Math.abs(a);if(c<jstat.DBL_EPSILON)return a;if(c>0.697)return Math.exp(a)-1;c=c>1.0E-8?Math.exp(a)-1:(a/2+1)*a;c-=(1+c)*(jstat.log1p(c)-a);return c};
jstat.logBeta=function(a,c){var b,d,e;d=e=a;c<d&&(d=c);c>e&&(e=c);if(d<0)return console.warn("Both arguements must be >= 0"),Number.NaN;else if(d==0)return Number.POSITIVE_INFINITY;else if(!jstat.isFinite(e))return Number.NEGATIVE_INFINITY;return d>=10?(b=jstat.lgammacor(d)+jstat.lgammacor(e)-jstat.lgammacor(d+e),Math.log(e)*-0.5+jstat.LN_SQRT_2PI+b+(d-0.5)*Math.log(d/(d+e))+e*jstat.log1p(-d/(d+e))):e>=10?(b=jstat.lgammacor(e)-jstat.lgammacor(d+e),jstat.lgamma(d)+b+d-d*Math.log(d+e)+(e-0.5)*jstat.log1p(-d/
(d+e))):Math.log(jstat.gamma(d)*(jstat.gamma(e)/jstat.gamma(d+e)))};
jstat.dbinom_raw=function(a,c,b,d,e){e==null&&(e=false);if(b==0)return a==0?e?0:1:e?Number.NEGATIVE_INFINITY:0;if(d==0)return a==c?e?0:1:e?Number.NEGATIVE_INFINITY:0;if(a==0){if(c==0)return e?0:1;b=b<0.1?-jstat.bd0(c,c*d)-c*b:c*Math.log(d);return e?b:Math.exp(b)}if(a==c)return b=d<0.1?-jstat.bd0(c,c*b)-c*d:c*Math.log(b),e?b:Math.exp(b);if(a<0||a>c)return e?Number.NEGATIVE_INFINITY:0;b=jstat.stirlerr(c)-jstat.stirlerr(a)-jstat.stirlerr(c-a)-jstat.bd0(a,c*b)-jstat.bd0(c-a,c*d);a=Math.log(jstat.TWO_PI)+
Math.log(a)+jstat.log1p(-a/c);return e?b-0.5*a:Math.exp(b-0.5*a)};jstat.max=function(a){for(var c=Number.NEGATIVE_INFINITY,b=0;b<a.length;b++)a[b]>c&&(c=a[b]);return c};
var Range=Class.extend({init:function(a,c,b){this._minimum=parseFloat(a);this._maximum=parseFloat(c);this._numPoints=parseFloat(b)},getMinimum:function(){return this._minimum},getMaximum:function(){return this._maximum},getNumPoints:function(){return this._numPoints},getPoints:function(){for(var a=[],c=this._minimum,b=(this._maximum-this._minimum)/(this._numPoints-1),d=0;d<this._numPoints;d++)a[d]=parseFloat(c.toFixed(6)),c+=b;return a}});
Range.validate=function(a){return!a instanceof Range?false:isNaN(a.getMinimum())||isNaN(a.getMaximum())||isNaN(a.getNumPoints())||a.getMaximum()<a.getMinimum()||a.getNumPoints()<=0?false:true};
var ContinuousDistribution=Class.extend({init:function(a){this._name=a},toString:function(){return this._string},getName:function(){return this._name},getClassName:function(){return this._name+"Distribution"},density:function(a){if(isNaN(a))if(Range.validate(a)){for(var a=a.getPoints(),c=[],b=0;b<a.length;b++)c[b]=parseFloat(this._pdf(a[b]));return c}else throw"Invalid parameter supplied to "+this.getClassName()+".density()";else return parseFloat(this._pdf(a).toFixed(15))},cumulativeDensity:function(a){if(isNaN(a))if(Range.validate(a)){for(var a=
a.getPoints(),c=[],b=0;b<a.length;b++)c[b]=parseFloat(this._cdf(a[b]));return c}else throw"Invalid parameter supplied to "+this.getClassName()+".cumulativeDensity()";else return parseFloat(this._cdf(a).toFixed(15))},getRange:function(a,c){a==null&&(a=5);c==null&&(c=100);var b=this.getMean()-a*Math.sqrt(this.getVariance()),d=this.getMean()+a*Math.sqrt(this.getVariance());this.getClassName()=="GammaDistribution"||this.getClassName()=="LogNormalDistribution"?(b=0,d=this.getMean()+a*Math.sqrt(this.getVariance())):
this.getClassName()=="BetaDistribution"&&(b=0,d=1);return new Range(b,d,c)},getVariance:function(){},getMean:function(){},getQuantile:function(a){function c(a,d){for(var g=a.getPoints(),i=0,h=999,k=0;k<g.length;k++){var l=b.cumulativeDensity(g[k]),l=Math.abs(l-d);l<h&&(i=k,h=l)}return h<=1.0E-5?g[i]:(g=new Range(g[i-1],g[i+1],20),c(g,d))}var b=this,d=this.getRange(5,20);return c(d,a)}}),NormalDistribution=ContinuousDistribution.extend({init:function(a,c){this._super("Normal");this._mean=parseFloat(a);
this._sigma=parseFloat(c);this._string="Normal ("+this._mean.toFixed(2)+", "+this._sigma.toFixed(2)+")"},_pdf:function(a,c){c==null&&(c=false);var b=this._sigma,d=this._mean;if(!jstat.isFinite(b))return c?Number.NEGATIVE_INFINITY:0;if(!jstat.isFinite(a)&&d==a)return Number.NaN;if(b<=0){if(b<0)throw"invalid sigma in _pdf";return a==d?Number.POSITIVE_INFINITY:c?Number.NEGATIVE_INFINITY:0}a=(a-d)/b;return!jstat.isFinite(a)?c?Number.NEGATIVE_INFINITY:0:c?-(jstat.LN_SQRT_2PI+0.5*a*a+Math.log(b)):jstat.ONE_SQRT_2PI*
Math.exp(-0.5*a*a)/b},_cdf:function(a,c,b){c==null&&(c=true);b==null&&(b=false);var d,e=this._mean;d=this._sigma;var f,g;c?b?(f=Number.NEGATIVE_INFINITY,g=0):(f=0,g=1):b?(f=0,g=Number.NEGATIVE_INFINITY):(f=1,g=0);if(!jstat.isFinite(a)&&e==a)return Number.NaN;if(d<=0)return d<0?(console.warn("Sigma is less than 0"),Number.NaN):a<e?f:g;d=(a-e)/d;if(!jstat.isFinite(d))return a<e?f:g;a=d;e=void 0;g=c?false:true;var i=[2.2352520354606837,161.02823106855587,1067.6894854603709,18154.98125334356,0.06568233791820745],
h=[47.202581904688245,976.0985517377767,10260.932208618979,45507.78933502673],k=[0.39894151208813466,8.883149794388377,93.50665613217785,597.2702763948002,2494.5375852903726,6848.190450536283,11602.65143764735,9842.714838383978,1.0765576773720192E-8],l=[22.266688044328117,235.387901782625,1519.3775994075547,6485.558298266761,18615.571640885097,34900.95272114598,38912.00328609327,19685.429676859992],q=[0.215898534057957,0.12740116116024736,0.022235277870649807,0.0014216191932278934,2.9112874951168793E-5,
0.023073441764940174],n=[1.284260096144911,0.4682382124808651,0.06598813786892856,0.0037823963320275824,7.297515550839662E-5],m,o,r,p;m=jstat.DBL_EPSILON*0.5;f=g!=1;g=g!=0;r=Math.abs(a);if(r<=0.67448975){if(r>m){k=a*a;o=i[4]*k;m=k;for(p=0;p<3;++p)o=(o+i[p])*k,m=(m+h[p])*k}else o=m=0;i=a*(o+i[3])/(m+h[3]);f&&(d=0.5+i);g&&(e=0.5-i);b&&(f&&(d=Math.log(d)),g&&(e=Math.log(e)))}else if(r<=jstat.SQRT_32){o=k[8]*r;m=r;for(p=0;p<7;++p)o=(o+k[p])*r,m=(m+l[p])*r;i=(o+k[7])/(m+l[7]);k=jstat.trunc(a*16)/16;h=
(a-k)*(a+k);if(b){if(d=-k*k*0.5+-h*0.5+Math.log(i),f&&a>0||g&&a<=0)e=jstat.log1p(-Math.exp(-k*k*0.5)*Math.exp(-h*0.5)*i)}else d=Math.exp(-k*k*0.5)*Math.exp(-h*0.5)*i,e=1-d;a>0&&(i=d,f&&(d=e),e=i)}else if(b&&r<1.0E170||f&&-37.5193<a&&a<8.2924||g&&-8.2924<a&&a<37.5193){k=1/(a*a);o=q[5]*k;m=k;for(p=0;p<4;++p)o=(o+q[p])*k,m=(m+n[p])*k;i=k*(o+q[4])/(m+n[4]);i=(jstat.ONE_SQRT_2PI-i)/r;k=jstat.trunc(a*16)/16;h=(a-k)*(a+k);if(b){if(d=-k*k*0.5+-h*0.5+Math.log(i),f&&a>0||g&&a<=0)e=jstat.log1p(-Math.exp(-k*
k*0.5)*Math.exp(-h*0.5)*i)}else d=Math.exp(-k*k*0.5)*Math.exp(-h*0.5)*i,e=1-d;a>0&&(i=d,f&&(d=e),e=i)}else a>0?(d=b?0:1,e=b?Number.NEGATIVE_INFINITY:0):(d=b?Number.NEGATIVE_INFINITY:0,e=b?0:1);a=[d,e];return c?a[0]:a[1]},getMean:function(){return this._mean},getSigma:function(){return this._sigma},getVariance:function(){return this._sigma*this._sigma}}),LogNormalDistribution=ContinuousDistribution.extend({init:function(a,c){this._super("LogNormal");this._location=parseFloat(a);this._scale=parseFloat(c);
this._string="LogNormal ("+this._location.toFixed(2)+", "+this._scale.toFixed(2)+")"},_pdf:function(a,c){var b,d=this._scale;b=this._location;c==null&&(c=false);if(d<=0)throw"Illegal parameter in _pdf";if(a<=0)return c?Number.NEGATIVE_INFINITY:0;b=(Math.log(a)-b)/d;return c?-(jstat.LN_SQRT_2PI+0.5*b*b+Math.log(a*d)):jstat.ONE_SQRT_2PI*Math.exp(-0.5*b*b)/(a*d)},_cdf:function(a,c,b){var d=this._scale,e=this._location;c==null&&(c=true);b==null&&(b=false);if(d<=0)throw"illegal std in _cdf";return a>0?
(new NormalDistribution(e,d))._cdf(Math.log(a),c,b):c?b?Number.NEGATIVE_INFINITY:0:b?0:1},getLocation:function(){return this._location},getScale:function(){return this._scale},getMean:function(){return Math.exp((this._location+this._scale)/2)},getVariance:function(){return(Math.exp(this._scale)-1)*Math.exp(2*this._location+this._scale)}}),GammaDistribution=ContinuousDistribution.extend({init:function(a,c){this._super("Gamma");this._shape=parseFloat(a);this._scale=parseFloat(c);this._string="Gamma ("+
this._shape.toFixed(2)+", "+this._scale.toFixed(2)+")"},_pdf:function(a,c){var b,d=this._shape,e=this._scale;c==null&&(c=false);if(d<0||e<=0)throw"Illegal argument in _pdf";if(a<0)return c?Number.NEGATIVE_INFINITY:0;if(d==0)return a==0?Number.POSITIVE_INFINITY:c?Number.NEGATIVE_INFINITY:0;if(a==0)return d<1?Number.POSITIVE_INFINITY:d>1?c?Number.NEGATIVE_INFINITY:0:c?-Math.log(e):1/e;if(d<1)return b=jstat.dopois_raw(d,a/e,c),c?b+Math.log(d/a):b*d/a;b=jstat.dopois_raw(d-1,a/e,c);return c?b-Math.log(e):
b/e},_cdf:function(a,c,b){function d(){g=Math.sqrt(e)*3*(Math.pow(a/e,1/3)+1/(9*e)-1);return(new NormalDistribution(0,1))._cdf(g,c,b)}c==null&&(c=true);b==null&&(b=false);var e=this._shape,f=this._scale,g,i,h,k,l,q,n,m,o,r,p;if(e<=0||f<=0)return console.warn("Invalid gamma params in _cdf"),Number.NaN;a/=f;if(isNaN(a))return a;if(a<=0)return c?b?Number.NEGATIVE_INFINITY:0:b?0:1;if(e>1E5)return d();if(a>1E8*e)return a>jstat.DBL_MAX*e?c?b?0:1:b?Number.NEGATIVE_INFINITY:0:d();if(a<=1||a<e){p=1;f=e*Math.log(a)-
a-jstat.lgamma(e+1);o=h=1;n=e;do n+=1,h*=a/n,o+=h;while(h>jstat.DBL_EPSILON*o)}else{p=0;f=e*Math.log(a)-a-jstat.lgamma(e);n=1-e;m=n+a+1;g=1;i=a;h=a+1;k=a*m;o=h/k;for(r=1;;r++){n+=1;m+=2;q=n*r;l=m*h-q*g;q=m*k-q*i;if(Math.abs(q)>0&&(i=o,o=l/q,Math.abs(i-o)<=jstat.DBL_EPSILON*jstat.fmin2(1,o)))break;g=h;i=k;h=l;k=q;Math.abs(l)>=1.0E37&&(g/=1.0E37,i/=1.0E37,h/=1.0E37,k/=1.0E37)}}f+=Math.log(o);c=c==p;return b&&c?f:c?Math.exp(f):b?f>-Math.LN2?Math.log(-jstat.expm1(f)):jstat.log1p(-Math.exp(f)):-jstat.expm1(f)},
getShape:function(){return this._shape},getScale:function(){return this._scale},getMean:function(){return this._shape*this._scale},getVariance:function(){return this._shape*Math.pow(this._scale,2)}}),BetaDistribution=ContinuousDistribution.extend({init:function(a,c){this._super("Beta");this._alpha=parseFloat(a);this._beta=parseFloat(c);this._string="Beta ("+this._alpha.toFixed(2)+", "+this._beta.toFixed(2)+")"},_pdf:function(a,c){c==null&&(c=false);var b=this._alpha,d=this._beta;if(b<=0||d<=0)return console.warn("Illegal arguments in _pdf"),
Number.NaN;if(a<0||a>1)return c?Number.NEGATIVE_INFINITY:0;if(a==0)return b>1?c?Number.NEGATIVE_INFINITY:0:b<1?Number.POSITIVE_INFINITY:c?Math.log(d):d;if(a==1)return d>1?c?Number.NEGATIVE_INFINITY:0:d<1?Number.POSITIVE_INFINITY:c?Math.log(b):b;b=b<=2||d<=2?(b-1)*Math.log(a)+(d-1)*jstat.log1p(-a)-jstat.logBeta(b,d):Math.log(b+d-1)+jstat.dbinom_raw(b-1,b+d-2,a,1-a,true);return c?b:Math.exp(b)},_cdf:function(a,c,b){c==null&&(c=true);b==null&&(b=false);var d=this._alpha,e=this._beta;return d<=0||e<=
0?(console.warn("Invalid argument in _cdf"),Number.NaN):a<=0?c?b?Number.NEGATIVE_INFINITY:0:b?0.1:1:a>=1?c?b?0.1:1:b?Number.NEGATIVE_INFINITY:0:jstat.incompleteBeta(d,e,a)},getAlpha:function(){return this._alpha},getBeta:function(){return this._beta},getMean:function(){return this._alpha/(this._alpha+this._beta)},getVariance:function(){return this._alpha*this._beta/(Math.pow(this._alpha+this._beta,2)*(this._alpha+this._beta+1))}}),StudentTDistribution=ContinuousDistribution.extend({init:function(a,
c){this._super("StudentT");this._dof=parseFloat(a);c!=null?(this._mu=parseFloat(c),this._string="StudentT ("+this._dof.toFixed(2)+", "+this._mu.toFixed(2)+")"):(this._mu=0,this._string="StudentT ("+this._dof.toFixed(2)+")")},_pdf:function(a,c){c==null&&(c=false);if(this._mu==null)return this._dt(a,c);else{var b=this._dnt(a,c);b>1&&console.warn("x:"+a+", y: "+b);return b}},_cdf:function(a,c,b){c==null&&(c=true);b==null&&(b=false);return this._mu==null?this._pt(a,c,b):this._pnt(a,c,b)},_dt:function(a,
c){var b,d,e=this._dof;if(e<=0)return console.warn("Invalid parameters in _dt"),Number.NaN;if(!jstat.isFinite(a))return c?Number.NEGATIVE_INFINITY:0;if(!jstat.isFinite(e))return(new NormalDistribution(0,1)).density(a,c);b=-jstat.bd0(e/2,(e+1)/2)+jstat.stirlerr((e+1)/2)-jstat.stirlerr(e/2);d=a*a>0.2*e?Math.log(1+a*a/e)*e/2:-jstat.bd0(e/2,(e+a*a)/2)+a*a/2;e=jstat.TWO_PI*(1+a*a/e);b-=d;return c?-0.5*Math.log(e)+b:Math.exp(b)/Math.sqrt(e)},_dnt:function(a,c){c==null&&(c=false);var b=this._dof,d=this._mu;
if(b<=0)return console.warn("Illegal arguments _dnf"),Number.NaN;if(d==0)return this._dt(a,c);if(!jstat.isFinite(a))return c?Number.NEGATIVE_INFINITY:0;if(!isFinite(b)||b>1E8)return(new NormalDistribution(d,1)).density(a,c);Math.abs(a)>Math.sqrt(b*jstat.DBL_EPSILON)?(d=new StudentTDistribution(b+2,d),b=Math.log(b)-Math.log(Math.abs(a))+Math.log(Math.abs(d._pnt(a*Math.sqrt((b+2)/b),true,false)-this._pnt(a,true,false)))):b=jstat.lgamma((b+1)/2)-jstat.lgamma(b/2)-0.5*(Math.log(Math.PI)+Math.log(b)+d*
d);return c?b:Math.exp(b)},_pt:function(a,c,b){c==null&&(c=true);b==null&&(b=false);var d,e;d=this._dof;var f,g;c?(f=b?Number.NEGATIVE_INFINITY:0,g=1):b?(f=0,g=Number.NEGATIVE_INFINITY):(f=1,g=0);if(d<=0)return console.warn("Invalid T distribution _pt"),Number.NaN;e=new NormalDistribution(0,1);if(!jstat.isFinite(a))return a<0?f:g;if(!jstat.isFinite(d))return e._cdf(a,c,b);if(d>4E5)return d=1/(4*d),e._cdf(a*(1-d)/sqrt(1+a*a*2*d),c,b);e=1+a/d*a;if(e>1.0E100)d=-0.5*d*(2*Math.log(Math.abs(a))-Math.log(d))-
jstat.logBeta(0.5*d,0.5)-Math.log(0.5*d),d=b?d:Math.exp(d);else return d>a*a?(c=new BetaDistribution(0.5,d/2),c._cdf(a*a/(d+a*a),false,b)):(c=new BetaDistribution(d/2,0.5),c._cdf(1/e,true,b));a<=0&&(c=!c);return b?c?jstat.log1p(-0.5*Math.exp(d)):d-M_LN2:(d/=2,c?0.5-d+0.5:d)},_pnt:function(a,c,b){var d=this._dof,e=this._mu,f,g;c?(f=b?Number.NEGATIVE_INFINITY:0,g=1):b?(f=0,g=Number.NEGATIVE_INFINITY):(f=1,g=0);var i,h,k,l,q,n,m,o,r,p,s;if(d<=0)return Number.NaN;else if(d==0)return this._pt(a);if(!jstat.isFinite(a))return a<
0?f:g;if(a>=0)g=false,l=a;else{if(e>=40&&(!b||!c))return f;g=true;l=-a;e=-e}if(d>4E5||e*e>2*Math.LN2*-jstat.DBL_MIN_EXP)return f=1/(4*d),a=new NormalDistribution(e,Math.sqrt(1+l*l*2*f)),a._cdf(l*(1-f),c!=g,b);a*=a;k=d/(a+d);a/=a+d;if(a>0){l=e*e;m=0.5*Math.exp(-0.5*l);if(m==0)return console.warn("underflow in _pnt"),f;o=jstat.SQRT_2dPI*m*e;f=0.5-m;f<1.0E-7&&(f=-0.5*jstat.expm1(-0.5*l));h=0.5;d*=0.5;k=Math.pow(k,d);i=jstat.LN_SQRT_PI+jstat.lgamma(d)-jstat.lgamma(0.5+d);p=jstat.incompleteBeta(h,d,a);
n=2*k*Math.exp(h*Math.log(a)-i);i=d*a;r=i<jstat.DBL_EPSILON?i:1-k;q=i*k;i=m*p+o*r;for(s=1;s<=1E3;s++){h+=1;p-=n;r-=q;n*=a*(h+d-1)/h;q*=a*(h+d-0.5)/(h+0.5);m*=l/(2*s);o*=l/(2*s+1);i+=m*p+o*r;f-=m;if(f<-1.0E-10)break;if(f<=0&&s>1)break;k=2*f*(p-n);if(Math.abs(k)<1.0E-7)break}if(s==1E3)throw"Non-convergence _pnt";}else i=0;a=new NormalDistribution(0,1);i+=a._cdf(-e,true,false);c=c!=g;g=jstat.fmin2(i,1);return c?b?Math.log(g):g:b?jstat.log1p(-g):0.5-g+0.5},getDegreesOfFreedom:function(){return this._dof},
getNonCentralityParameter:function(){return this._mu},getMean:function(){if(this._dof>1){var a=0.5*Math.log(this._dof/2)+jstat.lgamma((this._dof-1)/2)-jstat.lgamma(this._dof/2);return Math.exp(a)*this._mu}else return Number.NaN},getVariance:function(){return this._dof>2?this._dof*(1+this._mu*this._mu)/(this._dof-2)-this._mu*this._mu*this._dof/2*Math.pow(Math.exp(jstat.lgamma((this._dof-1)/2)-jstat.lgamma(this._dof/2)),2):Number.NaN}}),Plot=Class.extend({init:function(a,c){this._container="#"+String(a);
this._plots=[];this._flotObj=null;this._locked=false;this._options=c!=null?c:{}},getContainer:function(){return this._container},getGraph:function(){return this._flotObj},setData:function(a){this._plots=a},clear:function(){this._plots=[]},showLegend:function(){this._options.legend={show:true};this.render()},hideLegend:function(){this._options.legend={show:false};this.render()},render:function(){this._flotObj=null;this._flotObj=$.plot($(this._container),this._plots,this._options)}}),DistributionPlot=
Plot.extend({init:function(a,c,b,d){this._super(a,d);this._showPDF=true;this._showCDF=false;this._pdfValues=[];this._cdfValues=[];this._maxY=1;this._plotType="line";this._fill=false;this._distribution=c;this._range=b!=null&&Range.validate(b)?b:this._distribution.getRange();this._distribution!=null?this._maxY=this._generateValues():(this._options.xaxis={min:b.getMinimum(),max:b.getMaximum()},this._options.yaxis={max:1});this.render()},setHover:function(a){if(a){this._options.grid==null?this._options.grid=
{hoverable:true,mouseActiveRadius:25}:(this._options.grid.hoverable=true,this._options.grid.mouseActiveRadius=25);var c=null;$(this._container).bind("plothover",function(a,d,e){$("#x").text(d.x.toFixed(2));$("#y").text(d.y.toFixed(2));if(e){if(c!=e.datapoint){c=e.datapoint;$("#jstat_tooltip").remove();var f=jstat.toSigFig(e.datapoint[0],2),g=jstat.toSigFig(e.datapoint[1],2),a=null,d=e.series.color;e.series.label=="PDF"?(a="P("+f+") = "+g,d=["#fee","#fdd","#C05F5F"]):(a="F("+f+") = "+g,d=["#eef","#ddf",
"#4A4AC0"]);f=e.pageX;e=e.pageY;$('<div id="jstat_tooltip">'+a+"</div>").css({position:"absolute",display:"none",top:e+15,"font-size":"small",left:f+5,border:"1px solid "+d[1],color:d[2],padding:"5px","background-color":d[0],opacity:0.8}).appendTo("body").show()}}else $("#jstat_tooltip").remove(),c=null});$(this._container).bind("mouseleave",function(){$("#jstat_tooltip").is(":visible")&&($("#jstat_tooltip").remove(),c=null)})}else this._options.grid==null?this._options.grid={hoverable:false}:this._options.grid.hoverable=
false,$(this._container).unbind("plothover");this.render()},setType:function(a){this._plotType=a;var a={},c={};if(this._plotType=="line")a.show=true,c.show=false;else if(this._plotType=="points")a.show=false,c.show=true;else if(this._plotType=="both")a.show=true,c.show=true;this._options.series==null?this._options.series={lines:a,points:c}:(this._options.series.lines==null?this._options.series.lines=a:this._options.series.lines.show=a.show,this._options.series.points==null?this._options.series.points=
c:this._options.series.points.show=c.show);this.render()},setFill:function(a){this._fill=a;this._options.series==null?this._options.series={lines:{fill:a}}:this._options.series.lines==null?this._options.series.lines={fill:a}:this._options.series.lines.fill=a;this.render()},clear:function(){this._super();this._distribution=null;this._pdfValues=[];this._cdfValues=[];this.render()},_generateValues:function(){this._cdfValues=[];this._pdfValues=[];var a=this._range.getPoints();this._options.xaxis={min:a[0],
max:a[a.length-1]};for(var c=this._distribution.density(this._range),b=this._distribution.cumulativeDensity(this._range),d=0;d<a.length;d++){if(c[d]==Number.POSITIVE_INFINITY||c[d]==Number.NEGATIVE_INFINITY)c[d]=null;if(b[d]==Number.POSITIVE_INFINITY||b[d]==Number.NEGATIVE_INFINITY)b[d]=null;this._pdfValues.push([a[d],c[d]]);this._cdfValues.push([a[d],b[d]])}return jstat.max(c)},showPDF:function(){this._showPDF=true;this.render()},hidePDF:function(){this._showPDF=false;this.render()},showCDF:function(){this._showCDF=
true;this.render()},hideCDF:function(){this._showCDF=false;this.render()},setDistribution:function(a,c){this._distribution=a;this._range=c!=null?c:a.getRange();this._maxY=this._generateValues();this._options.yaxis={max:this._maxY*1.1};this.render()},getDistribution:function(){return this._distribution},getRange:function(){return this._range},setRange:function(a){this._range=a;this._generateValues();this.render()},render:function(){if(this._distribution!=null)if(this._showPDF&&this._showCDF)this.setData([{yaxis:1,
data:this._pdfValues,color:"rgb(237,194,64)",clickable:false,hoverable:true,label:"PDF"},{yaxis:2,data:this._cdfValues,clickable:false,color:"rgb(175,216,248)",hoverable:true,label:"CDF"}]),this._options.yaxis={max:this._maxY*1.1};else if(this._showPDF)this.setData([{data:this._pdfValues,hoverable:true,color:"rgb(237,194,64)",clickable:false,label:"PDF"}]),this._options.yaxis={max:this._maxY*1.1};else{if(this._showCDF)this.setData([{data:this._cdfValues,hoverable:true,color:"rgb(175,216,248)",clickable:false,
label:"CDF"}]),this._options.yaxis={max:1.1}}else this.setData([]);this._super()}}),DistributionFactory={build:function(a){if(a.NormalDistribution)if(a.NormalDistribution.mean!=null&&a.NormalDistribution.standardDeviation!=null)return new NormalDistribution(a.NormalDistribution.mean[0],a.NormalDistribution.standardDeviation[0]);else throw"Malformed JSON provided to DistributionBuilder "+a;else if(a.LogNormalDistribution)if(a.LogNormalDistribution.location!=null&&a.LogNormalDistribution.scale!=null)return new LogNormalDistribution(a.LogNormalDistribution.location[0],
a.LogNormalDistribution.scale[0]);else throw"Malformed JSON provided to DistributionBuilder "+a;else if(a.BetaDistribution)if(a.BetaDistribution.alpha!=null&&a.BetaDistribution.beta!=null)return new BetaDistribution(a.BetaDistribution.alpha[0],a.BetaDistribution.beta[0]);else throw"Malformed JSON provided to DistributionBuilder "+a;else if(a.GammaDistribution)if(a.GammaDistribution.shape!=null&&a.GammaDistribution.scale!=null)return new GammaDistribution(a.GammaDistribution.shape[0],a.GammaDistribution.scale[0]);
else throw"Malformed JSON provided to DistributionBuilder "+a;else if(a.StudentTDistribution)if(a.StudentTDistribution.degreesOfFreedom!=null&&a.StudentTDistribution.nonCentralityParameter!=null)return new StudentTDistribution(a.StudentTDistribution.degreesOfFreedom[0],a.StudentTDistribution.nonCentralityParameter[0]);else if(a.StudentTDistribution.degreesOfFreedom!=null)return new StudentTDistribution(a.StudentTDistribution.degreesOfFreedom[0]);else throw"Malformed JSON provided to DistributionBuilder "+
a;else throw"Malformed JSON provided to DistributionBuilder "+a;}};
