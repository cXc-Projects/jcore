(function(j){function z(c,b,h){if(typeof c=="undefined"||c.length==0)c=j("body");else if(typeof c=="string")c=j(c);if(typeof c!="object")return false;if(typeof b=="undefined")b="";c.find("a"+b).each(function(){var a=this.hash||"";a.length>0&&l(h).index(j(a))!=-1&&j(this).unbind("click").click(function(g){h.trigger("slideTo",a);g.preventDefault()})})}function D(c,b){if(c.items.minimum>=b){r("Not enough items: not scrolling");var h="hide"}else h="show";c.prev.button&&c.prev.button[h]();c.next.button&&
c.next.button[h]();c.pagination.container&&c.pagination.container[h]()}function J(c){if(c=="right")return 39;if(c=="left")return 37;if(c=="up")return 38;if(c=="down")return 40;return-1}function A(c,b,h){if(typeof b!="boolean")b=false;if(typeof h!="boolean")h=false;if(typeof c=="undefined")c={};if(typeof c=="string"){var a=J(c);c=a==-1?j(c):a}if(b){if(typeof c.jquery!="undefined")c={container:c};if(typeof Object=="boolean")c={keys:c};if(typeof c.container=="string")c.container=j(c.container)}else if(h){if(typeof c==
"boolean")c={play:c};if(typeof c=="number")c={pauseDuration:c}}else{if(typeof c.jquery!="undefined")c={button:c};if(typeof c=="number")c={key:c};if(typeof c.button=="string")c.button=j(c.button);if(typeof c.key=="string")c.key=J(c.key)}return c}function l(c,b){if(typeof b!="string")b="";return j("> *"+b,c)}function K(c,b,h){var a=l(c,":lt("+b.items.visible+")");c=l(c,":lt("+(b.items.visible+h)+"):gt("+(h-1)+")");return[a,c]}function E(c,b,h,a,g,k){if(typeof c=="string")c=isNaN(c)?j(c):parseInt(c);
if(typeof c=="object"){if(typeof c.jquery=="undefined")c=j(c);c=l(k).index(c);if(c==-1)c=0;if(typeof h!="boolean")h=false}else if(typeof h!="boolean")h=true;c=isNaN(c)?0:parseInt(c);b=isNaN(b)?0:parseInt(b);if(h)c+=a;for(c+=b;c>=g;)c-=g;for(;c<0;)c+=g;return c}function t(c,b,h){if(typeof h!="boolean")h=false;var a=c.dimentions,g=0,k=0;if(h&&typeof c[a[0]]=="number")g+=c[a[0]];else if(typeof c.items[a[0]]=="number")g+=c.items[a[0]]*b.length;else b.each(function(){g+=j(this)[a[1]](true)});if(h&&typeof c[a[2]]==
"number")k+=c[a[2]];else if(typeof c.items[a[2]]=="number")k+=c.items[a[2]];else b.each(function(){var u=j(this)[a[3]](true);if(k<u)k=u});return[g,k]}function F(c,b){var h=b.usePadding?b.padding:[0,0,0,0],a={};a[b.dimentions[0]]=c[0]+h[1]+h[3];a[b.dimentions[2]]=c[1]+h[0]+h[2];return a}function B(c,b){var h=c.parent(),a=l(c),g=a.filter(":nth("+(b.items.visible-1)+")"),k=t(b,a);h.css(F(t(b,a.filter(":lt("+b.items.visible+")"),true),b));if(b.usePadding){g.css(b.dimentions[6],g.data("cfs_origCssMargin")+
b.padding[1]);c.css(b.dimentions[5],b.padding[0]);c.css(b.dimentions[4],b.padding[3])}c.css(b.dimentions[0],k[0]*2);c.css(b.dimentions[2],k[1])}function M(c){if(typeof c=="number")c=[c];else if(typeof c=="string")c=c.split("px").join("").split(" ");if(typeof c!="object"){r('Not a valid value, padding set to "0".');c=[0]}for(i in c)c[i]=parseInt(c[i]);switch(c.length){case 0:return[0,0,0,0];case 1:return[c[0],c[0],c[0],c[0]];case 2:return[c[0],c[1],c[0],c[1]];case 3:return[c[0],c[1],c[2],c[1]];default:return c}}
function r(c){if(typeof c=="string")c="carouFredSel: "+c;if(window.console&&window.console.log)window.console.log(c);else try{console.log(c)}catch(b){}return false}j.fn.carouFredSel=function(c){if(this.length>1)return this.each(function(){j(this).carouFredSel(c)});this.init=function(e){if(typeof e!="object")e={};if(typeof e.scroll=="number")e.scroll=e.scroll<=50?{items:e.scroll}:{duration:e.scroll};else if(typeof e.scroll=="string")e.scroll={easing:e.scroll};if(typeof e.items=="number")e.items={visible:e.items};
else if(typeof e.items=="string")e.items={width:e.items,height:e.items};a=j.extend(true,{},j.fn.carouFredSel.defaults,e);a.padding=M(a.padding);a.usePadding=a.padding[0]==0&&a.padding[1]==0&&a.padding[2]==0&&a.padding[3]==0?false:true;L=a.direction=="up"||a.direction=="left"?"next":"prev";if(a.direction=="right"||a.direction=="left")a.dimentions=["width","outerWidth","height","outerHeight","left","top","marginRight"];else{a.dimentions=["height","outerHeight","width","outerWidth","top","left","marginBottom"];
a.padding=[a.padding[3],a.padding[2],a.padding[1],a.padding[0]]}if(!a.items.width)a.items.width=l(b).outerWidth(true);if(!a.items.height)a.items.height=l(b).outerHeight(true);if(typeof a.items.minimum!="number")a.items.minimum=a.items.visible;if(typeof a.scroll.items!="number")a.scroll.items=a.items.visible;if(typeof a.scroll.duration!="number")a.scroll.duration=500;a.auto=A(a.auto,false,true);a.prev=A(a.prev);a.next=A(a.next);a.pagination=A(a.pagination,true);a.auto=j.extend({},a.scroll,a.auto);
a.prev=j.extend({},a.scroll,a.prev);a.next=j.extend({},a.scroll,a.next);a.pagination=j.extend({},a.scroll,a.pagination);if(typeof a.pagination.keys!="boolean")a.pagination.keys=false;if(typeof a.pagination.anchorBuilder!="function")a.pagination.anchorBuilder=j.fn.carouFredSel.pageAnchorBuilder;if(typeof a.auto.play!="boolean")a.auto.play=true;if(typeof a.auto.nap!="boolean")a.auto.nap=true;if(typeof a.auto.delay!="number")a.auto.delay=0;if(typeof a.auto.pauseDuration!="number")a.auto.pauseDuration=
a.auto.duration<10?2500:a.auto.duration*5};this.build=function(){h.css({position:"relative",overflow:"hidden"});b.data("cfs_origCss",{width:b.css("width"),height:b.css("height"),position:b.css("position"),top:b.css("top"),left:b.css("left")}).css({position:"absolute"});a.usePadding&&l(b).each(function(){var e=parseInt(j(this).css(a.dimentions[6]));if(isNaN(e))e=0;j(this).data("cfs_origCssMargin",e)});D(a,g)};this.bind_events=function(){b.bind("pause",function(e,d){if(typeof d!="boolean")d=false;if(d)G=
true;u!=null&&clearTimeout(u);H!=null&&clearInterval(H)}).bind("play",function(e,d,f,n){b.trigger("pause");if(a.auto.play){if(typeof n!="boolean")n=typeof f=="boolean"?f:typeof d=="boolean"?d:false;if(typeof f!="number")f=typeof d=="number"?d:0;if(d!="prev"&&d!="next")d=L;if(n)G=false;if(!G){u=setTimeout(function(){if(b.is(":animated"))b.trigger("play",d);else{I=0;b.trigger(d,a.auto)}},a.auto.pauseDuration+f-I);if(a.auto.pauseOnHover==="resume")H=setInterval(function(){I+=100},100)}}}).bind("prev",
function(e,d,f){if(b.is(":animated"))return false;if(a.items.minimum>=g)return r("Not enough items: not scrolling");if(typeof d=="number")f=d;if(typeof d!="object")d=a.prev;if(typeof f!="number")f=d.items;if(typeof f!="number")return r("Not a valid number: not scrolling");if(!a.circular){e=g-k;if(e-f<0)f=e;if(k==0)f=0}k+=f;if(k>=g)k-=g;if(!a.circular&&!a.infinite){k==0&&a.prev.button&&a.prev.button.addClass("disabled");a.next.button&&a.next.button.removeClass("disabled")}if(f==0){a.infinite&&b.trigger("next",
g-a.items.visible);return false}l(b,":gt("+(g-f-1)+")").prependTo(b);g<a.items.visible+f&&l(b,":lt("+(a.items.visible+f-g)+")").clone(true).appendTo(b);e=K(b,a,f);var n=l(b,":nth("+(f-1)+")"),m=e[1].filter(":last"),q=e[0].filter(":last");a.usePadding&&m.css(a.dimentions[6],m.data("cfs_origCssMargin"));var v=t(a,l(b,":lt("+f+")")),s=F(t(a,e[0],true),a);a.usePadding&&m.css(a.dimentions[6],m.data("cfs_origCssMargin")+a.padding[1]);m={};var w={},x={},o=d.duration;if(o=="auto")o=a.scroll.duration/a.scroll.items*
f;else if(o<=0)o=0;else if(o<10)o=v[0]/o;d.onBefore&&d.onBefore(e[1],e[0],s,o);if(a.usePadding){var p=a.padding[3];x[a.dimentions[6]]=n.data("cfs_origCssMargin");w[a.dimentions[6]]=q.data("cfs_origCssMargin")+a.padding[1];n.css(a.dimentions[6],n.data("cfs_origCssMargin")+a.padding[3]);n.stop().animate(x,{duration:o,easing:d.easing});q.stop().animate(w,{duration:o,easing:d.easing})}else p=0;m[a.dimentions[4]]=p;if(typeof a[a.dimentions[0]]!="number"&&typeof a.items[a.dimentions[0]]!="number"||typeof a[a.dimentions[2]]!=
"number"&&typeof a.items[a.dimentions[2]]!="number")h.stop().animate(s,{duration:o,easing:d.easing});b.data("cfs_numItems",f).data("cfs_slideObj",d).data("cfs_oldItems",e[1]).data("cfs_newItems",e[0]).data("cfs_wrapSize",s).css(a.dimentions[4],-v[0]).animate(m,{duration:o,easing:d.easing,complete:function(){b.data("cfs_slideObj").onAfter&&b.data("cfs_slideObj").onAfter(b.data("cfs_oldItems"),b.data("cfs_newItems"),b.data("cfs_wrapSize"));g<a.items.visible+b.data("cfs_numItems")&&l(b,":gt("+(g-1)+
")").remove();var y=l(b,":nth("+(a.items.visible+b.data("cfs_numItems")-1)+")");a.usePadding&&y.css(a.dimentions[6],y.data("cfs_origCssMargin"))}});b.trigger("updatePageStatus").trigger("play",o)}).bind("next",function(e,d,f){if(b.is(":animated"))return false;if(a.items.minimum>=g)return r("Not enough items: not scrolling");if(typeof d=="number")f=d;if(typeof d!="object")d=a.next;if(typeof f!="number")f=d.items;if(typeof f!="number")return r("Not a valid number: not scrolling");if(!a.circular)if(k==
0){if(f>g-a.items.visible)f=g-a.items.visible}else if(k-f<a.items.visible)f=k-a.items.visible;k-=f;if(k<0)k+=g;if(!a.circular&&!a.infinite){k==a.items.visible&&a.next.button&&a.next.button.addClass("disabled");a.prev.button&&a.prev.button.removeClass("disabled")}if(f==0){a.infinite&&b.trigger("prev",g-a.items.visible);return false}g<a.items.visible+f&&l(b,":lt("+(a.items.visible+f-g)+")").clone(true).appendTo(b);e=K(b,a,f);var n=l(b,":nth("+(f-1)+")"),m=e[0].filter(":last"),q=e[1].filter(":last");
if(a.usePadding){m.css(a.dimentions[6],m.data("cfs_origCssMargin"));q.css(a.dimentions[6],q.data("cfs_origCssMargin"))}var v=t(a,l(b,":lt("+f+")")),s=F(t(a,e[1],true),a);if(a.usePadding){m.css(a.dimentions[6],m.data("cfs_origCssMargin")+a.padding[1]);q.css(a.dimentions[6],q.data("cfs_origCssMargin")+a.padding[1])}var w={},x={},o={},p=d.duration;if(p=="auto")p=a.scroll.duration/a.scroll.items*f;else if(p<=0)p=0;else if(p<10)p=v[0]/p;d.onBefore&&d.onBefore(e[0],e[1],s,p);w[a.dimentions[4]]=-v[0];if(a.usePadding){x[a.dimentions[6]]=
m.data("cfs_origCssMargin");o[a.dimentions[6]]=n.data("cfs_origCssMargin")+a.padding[3];q.css(a.dimentions[6],q.data("cfs_origCssMargin")+a.padding[1]);m.stop().animate(x,{duration:p,easing:d.easing});n.stop().animate(o,{duration:p,easing:d.easing})}if(typeof a[a.dimentions[0]]!="number"&&typeof a.items[a.dimentions[0]]!="number"||typeof a[a.dimentions[2]]!="number"&&typeof a.items[a.dimentions[2]]!="number")h.stop().animate(s,{duration:p,easing:d.easing});b.data("cfs_numItems",f).data("cfs_slideObj",
d).data("cfs_oldItems",e[0]).data("cfs_newItems",e[1]).data("cfs_wrapSize",s).animate(w,{duration:p,easing:d.easing,complete:function(){b.data("cfs_slideObj").onAfter&&b.data("cfs_slideObj").onAfter(b.data("cfs_oldItems"),b.data("cfs_newItems"),b.data("cfs_wrapSize"));g<a.items.visible+b.data("cfs_numItems")&&l(b,":gt("+(g-1)+")").remove();b.css(a.dimentions[4],a.usePadding?a.padding[3]:0);var y=l(b,":lt("+b.data("cfs_numItems")+")").appendTo(b).filter(":last");a.usePadding&&y.css(a.dimentions[6],
y.data("cfs_origCssMargin"))}});b.trigger("updatePageStatus").trigger("play",p)}).bind("slideTo",function(e,d,f,n,m){if(b.is(":animated"))return false;d=E(d,f,n,k,g,b);if(d==0)return false;if(typeof m!="object")m=false;if(a.circular)d<g/2?b.trigger("next",[m,d]):b.trigger("prev",[m,g-d]);else k==0||k>d?b.trigger("next",[m,d]):b.trigger("prev",[m,g-d])}).bind("insertItem",function(e,d,f,n,m){if(typeof d=="object"&&typeof d.jquery=="undefined")d=j(d);if(typeof d=="string")d=j(d);if(typeof d!="object"||
typeof d.jquery=="undefined"||d.length==0)return r("Not a valid object.");if(typeof f=="undefined"||f=="end")b.append(d);else{f=E(f,m,n,k,g,b);e=l(b,":nth("+f+")");if(e.length){if(f<=k)k+=d.length;e.before(d)}else b.append(d)}g=l(b).length;z("",".caroufredsel",b);B(b,a);D(a,g);b.trigger("updatePageStatus",true)}).bind("removeItem",function(e,d,f,n){if(typeof d=="undefined"||d=="end")l(b,":last").remove();else{d=E(d,n,f,k,g,b);e=l(b,":nth("+d+")");if(e.length){if(d<k)k-=e.length;e.remove()}}g=l(b).length;
z("",".caroufredsel",b);B(b,a);D(a,g);b.trigger("updatePageStatus",true)}).bind("updatePageStatus",function(e,d){if(!a.pagination.container)return false;if(typeof d=="boolean"&&d){l(a.pagination.container).remove();for(var f=0;f<Math.ceil(g/a.items.visible);f++)a.pagination.container.append(a.pagination.anchorBuilder(f+1));l(a.pagination.container).unbind("click").each(function(n){j(this).click(function(m){b.trigger("slideTo",[n*a.items.visible,0,true,a.pagination]);m.preventDefault()})})}f=k==0?
0:Math.round((g-k)/a.items.visible);l(a.pagination.container).removeClass("selected").filter(":nth("+f+")").addClass("selected")});a.useScrollTo&&b.bind("scrollTo",function(e,d,f,n,m){b.trigger("slideTo",[d,f,n,m])})};this.bind_buttons=function(){a.auto.pauseOnHover&&a.auto.play&&h.hover(function(){b.trigger("pause")},function(){b.trigger("play")});if(a.prev.button){a.prev.button.click(function(e){b.trigger("prev");e.preventDefault()});a.prev.pauseOnHover&&a.auto.play&&a.prev.button.hover(function(){b.trigger("pause")},
function(){b.trigger("play")});!a.circular&&!a.infinite&&a.prev.button.addClass("disabled")}if(j.fn.mousewheel){a.prev.mousewheel&&h.mousewheel(function(e,d){if(d>0){num=typeof a.prev.mousewheel=="number"?a.prev.mousewheel:"";b.trigger("prev",num);e.preventDefault()}});a.next.mousewheel&&h.mousewheel(function(e,d){if(d<0){num=typeof a.next.mousewheel=="number"?a.next.mousewheel:"";b.trigger("next",num);e.preventDefault()}})}if(a.next.button){a.next.button.click(function(e){b.trigger("next");e.preventDefault()});
a.next.pauseOnHover&&a.auto.play&&a.next.button.hover(function(){b.trigger("pause")},function(){b.trigger("play")})}if(a.pagination.container){b.trigger("updatePageStatus",true);a.pagination.pauseOnHover&&a.auto.play&&a.pagination.container.hover(function(){b.trigger("pause")},function(){b.trigger("play")})}if(a.next.key||a.prev.key)j(document).keyup(function(e){e=e.keyCode;e==a.next.key&&b.trigger("next");e==a.prev.key&&b.trigger("prev")});a.pagination.keys&&j(document).keyup(function(e){e=e.keyCode;
if(e>=49&&e<58){e=(e-49)*a.items.visible;e<=g&&b.trigger("slideTo",[e,0,true,a.pagination])}});if(a.auto.play){b.trigger("play",a.auto.delay);j.fn.nap&&a.auto.nap&&b.nap("pause","play")}};this.destroy=function(){b.css(b.data("cfs_origCss")).unbind("pause").unbind("play").unbind("prev").unbind("next").unbind("scrollTo").unbind("slideTo").unbind("insertItem").unbind("removeItem").unbind("updatePageStatus");h.replaceWith(b);return this};this.configuration=function(e,d){if(typeof e=="undefined")return a;
if(typeof d=="undefined"){var f=eval("opts."+e);if(typeof f=="undefined")f="";return f}eval("opts."+e+" = b");this.init(a);B(b,a);return this};this.link_anchors=function(e,d){z(e,d,b)};var b=j(this),h=j(this).wrap('<div class="caroufredsel_wrapper" />').parent(),a={},g=l(b).length,k=0,u=null,H=null,I=0,G=false,L="next";this.init(c);this.build();this.bind_events();this.bind_buttons();z("",".caroufredsel",b);B(b,a);if(a.items.start!==0&&a.items.start!==false){var C=a.items.start;if(a.items.start===
true){C=window.location.hash;C.length||(C=0)}b.trigger("slideTo",[C,0,true,{duration:0}])}return this};j.fn.carouFredSel.defaults={infinite:true,circular:true,direction:"left",padding:0,useScrollTo:true,items:{visible:5,start:0},scroll:{easing:"swing",pauseOnHover:false,mousewheel:false}};j.fn.carouFredSel.pageAnchorBuilder=function(c){return'<a href="#"><span>'+c+"</span></a>"};j.fn.caroufredsel=function(c){this.carouFredSel(c)}})(jQuery);
