(function(k){function A(c,b,h){if(typeof c=="undefined"||c.length==0)c=k("body");else if(typeof c=="string")c=k(c);if(typeof c!="object")return false;if(typeof b=="undefined")b="";c.find("a"+b).each(function(){var a=this.hash||"";a.length>0&&m(h).index(k(a))!=-1&&k(this).unbind("click").click(function(g){g.preventDefault();h.trigger("slideTo",a)})})}function E(c,b){if(c.items.minimum>=b){r("Not enough items: not scrolling");var h="hide"}else h="show";c.prev.button&&c.prev.button[h]();c.next.button&&
c.next.button[h]();c.pagination.container&&c.pagination.container[h]()}function J(c){if(c=="right")return 39;if(c=="left")return 37;if(c=="up")return 38;if(c=="down")return 40;return-1}function B(c,b,h){if(typeof b!="boolean")b=false;if(typeof h!="boolean")h=false;if(typeof c=="undefined")c={};if(typeof c=="string"){var a=J(c);c=a==-1?k(c):a}if(b){if(typeof c.jquery!="undefined")c={container:c};if(typeof Object=="boolean")c={keys:c};if(typeof c.container=="string")c.container=k(c.container)}else if(h){if(typeof c==
"boolean")c={play:c};if(typeof c=="number")c={pauseDuration:c}}else{if(typeof c.jquery!="undefined")c={button:c};if(typeof c=="number")c={key:c};if(typeof c.button=="string")c.button=k(c.button);if(typeof c.key=="string")c.key=J(c.key)}return c}function m(c,b){if(typeof b!="string")b="";return k("> *"+b,c)}function K(c,b,h){var a=m(c,":lt("+b.items.visible+")");c=m(c,":lt("+(b.items.visible+h)+"):gt("+(h-1)+")");return[a,c]}function F(c,b,h,a,g,j){if(typeof c=="string")c=isNaN(c)?k(c):parseInt(c);
if(typeof c=="object"){if(typeof c.jquery=="undefined")c=k(c);c=m(j).index(c);if(c==-1)c=0;if(typeof h!="boolean")h=false}else if(typeof h!="boolean")h=true;c=isNaN(c)?0:parseInt(c);b=isNaN(b)?0:parseInt(b);if(h)c+=a;c+=b;if(g>0){for(;c>=g;)c-=g;for(;c<0;)c+=g}return c}function s(c,b,h){if(typeof h!="boolean")h=false;var a=c.dimentions,g=0,j=0;if(h&&typeof c[a[0]]=="number")g+=c[a[0]];else if(typeof c.items[a[0]]=="number")g+=c.items[a[0]]*b.length;else b.each(function(){g+=k(this)[a[1]](true)});
if(h&&typeof c[a[2]]=="number")j+=c[a[2]];else if(typeof c.items[a[2]]=="number")j+=c.items[a[2]];else b.each(function(){var v=k(this)[a[3]](true);if(j<v)j=v});return[g,j]}function G(c,b){var h=b.usePadding?b.padding:[0,0,0,0],a={};a[b.dimentions[0]]=c[0]+h[1]+h[3];a[b.dimentions[2]]=c[1]+h[0]+h[2];return a}function C(c,b){var h=c.parent(),a=m(c),g=a.filter(":nth("+(b.items.visible-1)+")"),j=s(b,a,false);h.css(G(s(b,a.filter(":lt("+b.items.visible+")"),true),b));if(b.usePadding){g.css(b.dimentions[6],
g.data("cfs_origCssMargin")+b.padding[1]);c.css(b.dimentions[5],b.padding[0]);c.css(b.dimentions[4],b.padding[3])}c.css(b.dimentions[0],j[0]*2);c.css(b.dimentions[2],j[1])}function N(c){if(typeof c=="number")c=[c];else if(typeof c=="string")c=c.split("px").join("").split(" ");if(typeof c!="object"){r('Not a valid value, padding set to "0".');c=[0]}for(i in c)c[i]=parseInt(c[i]);switch(c.length){case 0:return[0,0,0,0];case 1:return[c[0],c[0],c[0],c[0]];case 2:return[c[0],c[1],c[0],c[1]];case 3:return[c[0],
c[1],c[2],c[1]];default:return c}}function r(c){if(typeof c=="string")c="carouFredSel: "+c;if(window.console&&window.console.log)window.console.log(c);else try{console.log(c)}catch(b){}return false}k.fn.carouFredSel=function(c){if(this.length==0)return r("No element selected.");if(this.length>1)return this.each(function(){k(this).carouFredSel(c)});this.init=function(e){if(typeof e!="object")e={};if(typeof e.scroll=="number")e.scroll=e.scroll<=50?{items:e.scroll}:{duration:e.scroll};else if(typeof e.scroll==
"string")e.scroll={easing:e.scroll};if(typeof e.items=="number")e.items={visible:e.items};else if(typeof e.items=="string")e.items={visible:e.items,width:e.items,height:e.items};a=k.extend(true,{},k.fn.carouFredSel.defaults,e);a.padding=N(a.padding);a.usePadding=a.padding[0]==0&&a.padding[1]==0&&a.padding[2]==0&&a.padding[3]==0?false:true;L=a.direction=="up"||a.direction=="left"?"next":"prev";if(a.direction=="right"||a.direction=="left")a.dimentions=["width","outerWidth","height","outerHeight","left",
"top","marginRight","innerWidth"];else{a.dimentions=["height","outerHeight","width","outerWidth","top","left","marginBottom","innerHeight"];a.padding=[a.padding[3],a.padding[2],a.padding[1],a.padding[0]]}if(a[a.dimentions[2]]=="auto"){a[a.dimentions[2]]=s(a,m(b))[1];a.items[a.dimentions[2]]="auto"}else a.items[a.dimentions[2]]||(a.items[a.dimentions[2]]=m(b)[a.dimentions[3]](true));a.items[a.dimentions[0]]||(a.items[a.dimentions[0]]=m(b)[a.dimentions[1]](true));if(a.items.visible=="variable"){if(typeof a[a.dimentions[0]]==
"number"){a.maxDimention=a[a.dimentions[0]];a[a.dimentions[0]]=null}else a.maxDimention=h.parent()[a.dimentions[7]]();if(typeof a.items[a.dimentions[0]]=="number")a.items.visible=Math.floor(a.maxDimention/a.items[a.dimentions[0]]);else{M=true;a.items.visible=0}}if(typeof a.items.minimum!="number")a.items.minimum=a.items.visible;if(typeof a.scroll.items!="number")a.scroll.items=a.items.visible;if(typeof a.scroll.duration!="number")a.scroll.duration=500;a.auto=B(a.auto,false,true);a.prev=B(a.prev);
a.next=B(a.next);a.pagination=B(a.pagination,true);a.auto=k.extend({},a.scroll,a.auto);a.prev=k.extend({},a.scroll,a.prev);a.next=k.extend({},a.scroll,a.next);a.pagination=k.extend({},a.scroll,a.pagination);if(typeof a.pagination.keys!="boolean")a.pagination.keys=false;if(typeof a.pagination.anchorBuilder!="function")a.pagination.anchorBuilder=k.fn.carouFredSel.pageAnchorBuilder;if(typeof a.auto.play!="boolean")a.auto.play=true;if(typeof a.auto.nap!="boolean")a.auto.nap=true;if(typeof a.auto.delay!=
"number")a.auto.delay=0;if(typeof a.auto.pauseDuration!="number")a.auto.pauseDuration=a.auto.duration<10?2500:a.auto.duration*5};this.build=function(){h.css({position:"relative",overflow:"hidden"});b.data("cfs_origCss",{width:b.css("width"),height:b.css("height"),position:b.css("position"),top:b.css("top"),left:b.css("left")}).css({position:"absolute"});a.usePadding&&m(b).each(function(){var e=parseInt(k(this).css(a.dimentions[6]));if(isNaN(e))e=0;k(this).data("cfs_origCssMargin",e)});E(a,g)};this.bind_events=
function(){b.bind("pause",function(e,d){if(typeof d!="boolean")d=false;if(d)t=true;v!=null&&clearTimeout(v);H!=null&&clearInterval(H)});b.bind("play",function(e,d,f,n){b.trigger("pause");if(a.auto.play){if(typeof n!="boolean")n=typeof f=="boolean"?f:typeof d=="boolean"?d:false;if(typeof f!="number")f=typeof d=="number"?d:0;if(d!="prev"&&d!="next")d=L;if(n)t=false;if(!t){v=setTimeout(function(){if(b.is(":animated"))b.trigger("play",d);else{I=0;b.trigger(d,a.auto)}},a.auto.pauseDuration+f-I);if(a.auto.pauseOnHover===
"resume")H=setInterval(function(){I+=100},100)}}});if(M){b.bind("prev",function(e,d,f){if(!b.is(":animated"))if(!t){e=m(b);var n=0,l=0;if(typeof d=="number")f=d;if(typeof f!="number"){for(var o=e.length-1;o>=0;o--){current=e.filter(":eq("+o+")")[a.dimentions[1]](true);if(n+current>a.maxDimention)break;n+=current;l++}f=l}for(o=e.length-f;o<e.length;o++){current=e.filter(":eq("+o+")")[a.dimentions[1]](true);if(n+current>a.maxDimention)break;n+=current;if(o==e.length-1)o=0;l++}a.items.visible=l;b.trigger("scrollPrev",
[d,f])}});b.bind("next",function(e,d,f){if(!b.is(":animated"))if(!t){e=m(b);var n=0,l=0;if(typeof d=="number")f=d;if(typeof f!="number")f=a.items.visible;for(var o=f;o<e.length;o++){current=e.filter(":eq("+o+")")[a.dimentions[1]](true);if(n+current>a.maxDimention)break;n+=current;if(o==e.length-1)o=0;l++}a.items.visible=l;b.trigger("scrollNext",[d,f])}}).trigger("next",{duration:0})}else{b.bind("prev",function(e,d,f){b.trigger("scrollPrev",[d,f])});b.bind("next",function(e,d,f){b.trigger("scrollNext",
[d,f])})}b.bind("scrollPrev",function(e,d,f){if(!b.is(":animated"))if(!t){if(a.items.minimum>=g)return r("Not enough items: not scrolling");if(typeof d=="number")f=d;if(typeof d!="object")d=a.prev;if(typeof f!="number")f=d.items;if(typeof f!="number")return r("Not a valid number: not scrolling");if(!a.circular){e=g-j;if(e-f<0)f=e;if(j==0)f=0}j+=f;if(j>=g)j-=g;if(!a.circular){j==0&&f!=0&&a.prev.onEnd&&a.prev.onEnd();if(a.infinite){if(f==0){b.trigger("next",g-a.items.visible);return false}}else{j==
0&&a.prev.button&&a.prev.button.addClass("disabled");a.next.button&&a.next.button.removeClass("disabled")}}if(f==0)return false;m(b,":gt("+(g-f-1)+")").prependTo(b);g<a.items.visible+f&&m(b,":lt("+(a.items.visible+f-g)+")").clone(true).appendTo(b);e=K(b,a,f);var n=m(b,":nth("+(f-1)+")"),l=e[1].filter(":last"),o=e[0].filter(":last");a.usePadding&&l.css(a.dimentions[6],l.data("cfs_origCssMargin"));var w=s(a,m(b,":lt("+f+")")),u=G(s(a,e[0],true),a);a.usePadding&&l.css(a.dimentions[6],l.data("cfs_origCssMargin")+
a.padding[1]);l={};var x={},y={},p=d.duration;if(p=="auto")p=a.scroll.duration/a.scroll.items*f;else if(p<=0)p=0;else if(p<10)p=w[0]/p;d.onBefore&&d.onBefore(e[1],e[0],u,p);if(a.usePadding){var q=a.padding[3];y[a.dimentions[6]]=n.data("cfs_origCssMargin");x[a.dimentions[6]]=o.data("cfs_origCssMargin")+a.padding[1];n.css(a.dimentions[6],n.data("cfs_origCssMargin")+a.padding[3]);n.stop().animate(y,{duration:p,easing:d.easing});o.stop().animate(x,{duration:p,easing:d.easing})}else q=0;l[a.dimentions[4]]=
q;if(typeof a[a.dimentions[0]]!="number"&&typeof a.items[a.dimentions[0]]!="number"||typeof a[a.dimentions[2]]!="number"&&typeof a.items[a.dimentions[2]]!="number")h.stop().animate(u,{duration:p,easing:d.easing});b.data("cfs_numItems",f).data("cfs_slideObj",d).data("cfs_oldItems",e[1]).data("cfs_newItems",e[0]).data("cfs_wrapSize",u).css(a.dimentions[4],-w[0]).animate(l,{duration:p,easing:d.easing,complete:function(){b.data("cfs_slideObj").onAfter&&b.data("cfs_slideObj").onAfter(b.data("cfs_oldItems"),
b.data("cfs_newItems"),b.data("cfs_wrapSize"));g<a.items.visible+b.data("cfs_numItems")&&m(b,":gt("+(g-1)+")").remove();var z=m(b,":nth("+(a.items.visible+b.data("cfs_numItems")-1)+")");a.usePadding&&z.css(a.dimentions[6],z.data("cfs_origCssMargin"))}});b.trigger("updatePageStatus").trigger("play",p)}});b.bind("scrollNext",function(e,d,f){if(!b.is(":animated"))if(!t){if(a.items.minimum>=g)return r("Not enough items: not scrolling");if(typeof d=="number")f=d;if(typeof d!="object")d=a.next;if(typeof f!=
"number")f=d.items;if(typeof f!="number")return r("Not a valid number: not scrolling");if(!a.circular)if(j==0){if(f>g-a.items.visible)f=g-a.items.visible}else if(j-f<a.items.visible)f=j-a.items.visible;j-=f;if(j<0)j+=g;if(!a.circular){j==a.items.visible&&f!=0&&a.next.onEnd&&a.next.onEnd();if(a.infinite){if(f==0){b.trigger("prev",g-a.items.visible);return false}}else{j==a.items.visible&&a.next.button&&a.next.button.addClass("disabled");a.prev.button&&a.prev.button.removeClass("disabled")}}if(f==0)return false;
g<a.items.visible+f&&m(b,":lt("+(a.items.visible+f-g)+")").clone(true).appendTo(b);e=K(b,a,f);var n=m(b,":nth("+(f-1)+")"),l=e[0].filter(":last"),o=e[1].filter(":last");if(a.usePadding){l.css(a.dimentions[6],l.data("cfs_origCssMargin"));o.css(a.dimentions[6],o.data("cfs_origCssMargin"))}var w=s(a,m(b,":lt("+f+")")),u=G(s(a,e[1],true),a);if(a.usePadding){l.css(a.dimentions[6],l.data("cfs_origCssMargin")+a.padding[1]);o.css(a.dimentions[6],o.data("cfs_origCssMargin")+a.padding[1])}var x={},y={},p={},
q=d.duration;if(q=="auto")q=a.scroll.duration/a.scroll.items*f;else if(q<=0)q=0;else if(q<10)q=w[0]/q;d.onBefore&&d.onBefore(e[0],e[1],u,q);x[a.dimentions[4]]=-w[0];if(a.usePadding){y[a.dimentions[6]]=l.data("cfs_origCssMargin");p[a.dimentions[6]]=n.data("cfs_origCssMargin")+a.padding[3];o.css(a.dimentions[6],o.data("cfs_origCssMargin")+a.padding[1]);l.stop().animate(y,{duration:q,easing:d.easing});n.stop().animate(p,{duration:q,easing:d.easing})}if(typeof a[a.dimentions[0]]!="number"&&typeof a.items[a.dimentions[0]]!=
"number"||typeof a[a.dimentions[2]]!="number"&&typeof a.items[a.dimentions[2]]!="number")h.stop().animate(u,{duration:q,easing:d.easing});b.data("cfs_numItems",f).data("cfs_slideObj",d).data("cfs_oldItems",e[0]).data("cfs_newItems",e[1]).data("cfs_wrapSize",u).animate(x,{duration:q,easing:d.easing,complete:function(){b.data("cfs_slideObj").onAfter&&b.data("cfs_slideObj").onAfter(b.data("cfs_oldItems"),b.data("cfs_newItems"),b.data("cfs_wrapSize"));g<a.items.visible+b.data("cfs_numItems")&&m(b,":gt("+
(g-1)+")").remove();b.css(a.dimentions[4],a.usePadding?a.padding[3]:0);var z=m(b,":lt("+b.data("cfs_numItems")+")").appendTo(b).filter(":last");a.usePadding&&z.css(a.dimentions[6],z.data("cfs_origCssMargin"))}});b.trigger("updatePageStatus").trigger("play",q)}});b.bind("slideTo",function(e,d,f,n,l){if(b.is(":animated"))return false;d=F(d,f,n,j,g,b);if(d==0)return false;if(typeof l!="object")l=false;if(a.circular)d<g/2?b.trigger("next",[l,d]):b.trigger("prev",[l,g-d]);else j==0||j>d?b.trigger("next",
[l,d]):b.trigger("prev",[l,g-d])}).bind("insertItem",function(e,d,f,n,l){if(typeof d=="object"&&typeof d.jquery=="undefined")d=k(d);if(typeof d=="string")d=k(d);if(typeof d!="object"||typeof d.jquery=="undefined"||d.length==0)return r("Not a valid object.");if(typeof f=="undefined"||f=="end")b.append(d);else{f=F(f,l,n,j,g,b);e=m(b,":nth("+f+")");if(e.length){if(f<=j)j+=d.length;e.before(d)}else b.append(d)}g=m(b).length;A("",".caroufredsel",b);C(b,a);E(a,g);b.trigger("updatePageStatus",true)}).bind("removeItem",
function(e,d,f,n){if(typeof d=="undefined"||d=="end")m(b,":last").remove();else{d=F(d,n,f,j,g,b);e=m(b,":nth("+d+")");if(e.length){if(d<j)j-=e.length;e.remove()}}g=m(b).length;A("",".caroufredsel",b);C(b,a);E(a,g);b.trigger("updatePageStatus",true)}).bind("updatePageStatus",function(e,d){if(!a.pagination.container)return false;if(typeof d=="boolean"&&d){m(a.pagination.container).remove();for(var f=0;f<Math.ceil(g/a.items.visible);f++)a.pagination.container.append(a.pagination.anchorBuilder(f+1));
m(a.pagination.container).unbind("click").each(function(n){k(this).click(function(l){l.preventDefault();b.trigger("slideTo",[n*a.items.visible,0,true,a.pagination])})})}f=j==0?0:Math.round((g-j)/a.items.visible);m(a.pagination.container).removeClass("selected").filter(":nth("+f+")").addClass("selected")})};this.bind_buttons=function(){a.auto.pauseOnHover&&a.auto.play&&h.hover(function(){b.trigger("pause")},function(){b.trigger("play")});if(a.prev.button){a.prev.button.click(function(e){b.trigger("prev");
e.preventDefault()});a.prev.pauseOnHover&&a.auto.play&&a.prev.button.hover(function(){b.trigger("pause")},function(){b.trigger("play")});!a.circular&&!a.infinite&&a.prev.button.addClass("disabled")}if(k.fn.mousewheel){a.prev.mousewheel&&h.mousewheel(function(e,d){if(d>0){e.preventDefault();num=typeof a.prev.mousewheel=="number"?a.prev.mousewheel:"";b.trigger("prev",num)}});a.next.mousewheel&&h.mousewheel(function(e,d){if(d<0){e.preventDefault();num=typeof a.next.mousewheel=="number"?a.next.mousewheel:
"";b.trigger("next",num)}})}if(a.next.button){a.next.button.click(function(e){e.preventDefault();b.trigger("next")});a.next.pauseOnHover&&a.auto.play&&a.next.button.hover(function(){b.trigger("pause")},function(){b.trigger("play")})}if(a.pagination.container){b.trigger("updatePageStatus",true);a.pagination.pauseOnHover&&a.auto.play&&a.pagination.container.hover(function(){b.trigger("pause")},function(){b.trigger("play")})}if(a.next.key||a.prev.key)k(document).keyup(function(e){var d=e.keyCode;if(d==
a.next.key){e.preventDefault();b.trigger("next")}if(d==a.prev.key){e.preventDefault();b.trigger("prev")}});a.pagination.keys&&k(document).keyup(function(e){var d=e.keyCode;if(d>=49&&d<58){d=(d-49)*a.items.visible;if(d<=g){e.preventDefault();b.trigger("slideTo",[d,0,true,a.pagination])}}});if(a.auto.play){b.trigger("play",a.auto.delay);k.fn.nap&&a.auto.nap&&b.nap("pause","play")}};this.destroy=function(){b.trigger("pause").css(b.data("cfs_origCss")).unbind("pause").unbind("play").unbind("prev").unbind("next").unbind("scrollTo").unbind("slideTo").unbind("insertItem").unbind("removeItem").unbind("updatePageStatus");
h.replaceWith(b);return this};this.configuration=function(e,d){if(typeof e=="undefined")return a;if(typeof d=="undefined"){var f=eval("opts."+e);if(typeof f=="undefined")f="";return f}eval("opts."+e+" = b");this.init(a);C(b,a);return this};this.link_anchors=function(e,d){A(e,d,b)};this.current_position=function(){if(j==0)return 0;return g-j};var b=k(this);if(k(this).parent().is(".caroufredsel_wrapper")){var h=b.parent();this.destroy()}h=k(this).wrap('<div class="caroufredsel_wrapper" />').parent();
var a={},g=m(b).length,j=0,v=null,H=null,I=0,t=false,L="next",M=false;this.init(c);this.build();this.bind_events();this.bind_buttons();A("",".caroufredsel",b);C(b,a);if(a.items.start!==0&&a.items.start!==false){var D=a.items.start;if(a.items.start===true){D=window.location.hash;D.length||(D=0)}b.trigger("slideTo",[D,0,true,{duration:0}])}return this};k.fn.carouFredSel.defaults={infinite:true,circular:true,direction:"left",padding:0,items:{visible:5,start:0},scroll:{easing:"swing",pauseOnHover:false,
mousewheel:false}};k.fn.carouFredSel.pageAnchorBuilder=function(c){return'<a href="#"><span>'+c+"</span></a>"};k.fn.caroufredsel=function(c){this.carouFredSel(c)}})(jQuery);
