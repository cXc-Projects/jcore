(function(c){function s(d,a){var b=document.createElementNS("http://www.w3.org/2000/svg",d||"svg");a&&c.each(a,function(e,f){b.setAttributeNS(null,e,f)});return c(b)}c.fn.activity=function(d){this.each(function(){var a=c(this),b=a.data("activity");if(b){clearInterval(b.data("interval"));b.remove();a.removeData("activity")}if(d!==false){d=c.extend({color:a.css("color")},c.fn.activity.defaults,d);b=r(a,d).css("position","absolute").prependTo(d.outside?"body":a);var e=a.outerHeight()-b.height(),f=a.outerWidth()-
b.width();e={top:d.valign=="top"?d.padding:d.valign=="bottom"?e-d.padding:Math.floor(e/2),left:d.align=="left"?d.padding:d.align=="right"?f-d.padding:Math.floor(f/2)};f=a.offset();if(d.outside)b.css({top:f.top+"px",left:f.left+"px"});else{e.top-=b.offset().top-f.top;e.left-=b.offset().left-f.left}b.css({marginTop:e.top+"px",marginLeft:e.left+"px"});t(b,d.segments,Math.round(10/d.speed)/10);a.data("activity",b)}});return this};c.fn.activity.defaults={segments:12,space:3,length:7,width:4,speed:1.2,
align:"center",valign:"center",padding:4};c.fn.activity.getOpacity=function(d,a){var b=d.steps||d.segments-1;return 1-Math.min(a,b)*(1-(d.opacity!==undefined?d.opacity:1/b))/b};var r=function(){return c("<div>").addClass("busy")},t=function(){};if(document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect){r=function(d,a){for(var b=a.width*2+a.space,e=b+a.length+Math.ceil(a.width/2)+1,f=s().width(e*2).height(e*2),j=s("g",{"stroke-width":a.width,"stroke-linecap":"round",
stroke:a.color}).appendTo(s("g",{transform:"translate("+e+","+e+")"}).appendTo(f)),o=0;o<a.segments;o++)j.append(s("line",{x1:0,y1:b,x2:0,y2:b+a.length,transform:"rotate("+360/a.segments*o+", 0, 0)",opacity:c.fn.activity.getOpacity(a,o)}));return c("<div>").append(f).width(2*e).height(2*e)};if(document.createElement("div").style.WebkitAnimationName!==undefined){var n={};t=function(d,a,b){if(!n[a]){for(var e="spin"+a,f="@-webkit-keyframes "+e+" {",j=0;j<a;j++){var o="% { -webkit-transform:rotate("+
Math.round(360/a*j)+"deg); }\n";f+=Math.round(1E5/a*j)/1E3+o+Math.round(1E5/a*(j+1)-1)/1E3+o}f+="100% { -webkit-transform:rotate(100deg); }\n}";document.styleSheets[0].insertRule(f);n[a]=e}d.css("-webkit-animation",n[a]+" "+b+"s linear infinite")}}else t=function(d,a,b){var e=0,f=d.find("g g").get(0);d.data("interval",setInterval(function(){f.setAttributeNS(null,"transform","rotate("+ ++e%a*(360/a)+")")},b*1E3/a))}}else{var v=c("<shape>").css("behavior","url(#default#VML)").appendTo("body");if(v.get(0).adj){var i=
document.createStyleSheet();c.each(["group","shape","stroke"],function(){i.addRule(this,"behavior:url(#default#VML);")});r=function(d,a){var b=a.width*2+a.space,e=(b+a.length+Math.ceil(a.width/2)+1)*2,f=-Math.ceil(e/2);f=c("<group>",{coordsize:e+" "+e,coordorigin:f+" "+f}).css({top:f,left:f,width:e,height:e});for(var j=0;j<a.segments;j++)f.append(c("<shape>",{path:"m "+b+",0  l "+(b+a.length)+",0"}).css({width:e,height:e,rotation:360/a.segments*j+"deg"}).append(c("<stroke>",{color:a.color,weight:a.width+
"px",endcap:"round",opacity:c.fn.activity.getOpacity(a,j)})));return c("<group>",{coordsize:e+" "+e}).css({width:e,height:e,overflow:"hidden"}).append(f)};t=function(d,a,b){var e=0,f=d.get(0);d.data("interval",setInterval(function(){f.style.rotation=++e%a*(360/a)},b*1E3/a))}}c(v).remove()}})(jQuery);
(function(c){function s(d,a){var b=document.createElementNS("http://www.w3.org/2000/svg",d||"svg");a&&c.each(a,function(e,f){b.setAttributeNS(null,e,f)});return c(b)}c.fn.activity=function(d){this.each(function(){var a=c(this),b=a.data("activity");if(b){clearInterval(b.data("interval"));b.remove();a.removeData("activity")}if(d!==false){d=c.extend({color:a.css("color")},c.fn.activity.defaults,d);b=r(a,d).css("position","absolute").prependTo(d.outside?"body":a);var e={top:Math.floor((a.outerHeight()-
b.height())/2),left:Math.floor((a.outerWidth()-b.width())/2)},f=a.offset();if(d.outside)b.css({top:f.top+"px",left:f.left+"px"});else{e.top-=b.offset().top-f.top;e.left-=b.offset().left-f.left}b.css({marginTop:e.top+"px",marginLeft:e.left+"px"});t(b,d.segments,Math.round(10/d.speed)/10);a.data("activity",b)}});return this};c.fn.activity.defaults={segments:12,space:3,length:7,width:4,speed:1.2};c.fn.activity.getOpacity=function(d,a){var b=d.steps||d.segments-1;return 1-Math.min(a,b)*(1-(d.opacity!==
undefined?d.opacity:1/b))/b};var r=function(){return c("<div>").addClass("busy")},t=function(){};if(document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect){r=function(d,a){for(var b=a.width*2+a.space,e=b+a.length+Math.ceil(a.width/2)+1,f=s().width(e*2).height(e*2),j=s("g",{"stroke-width":a.width,"stroke-linecap":"round",stroke:a.color}).appendTo(s("g",{transform:"translate("+e+","+e+")"}).appendTo(f)),o=0;o<a.segments;o++)j.append(s("line",{x1:0,y1:b,
x2:0,y2:b+a.length,transform:"rotate("+360/a.segments*o+", 0, 0)",opacity:c.fn.activity.getOpacity(a,o)}));return c("<div>").append(f).width(2*e).height(2*e)};if(document.createElement("div").style.WebkitAnimationName!==undefined){var n={};t=function(d,a,b){if(!n[a]){for(var e="spin"+a,f="@-webkit-keyframes "+e+" {",j=0;j<a;j++){var o="% { -webkit-transform:rotate("+Math.round(360/a*j)+"deg); }\n";f+=Math.round(1E5/a*j)/1E3+o+Math.round(1E5/a*(j+1)-1)/1E3+o}f+="100% { -webkit-transform:rotate(100deg); }\n}";
document.styleSheets[0].insertRule(f);n[a]=e}d.css("-webkit-animation",n[a]+" "+b+"s linear infinite")}}else t=function(d,a,b){var e=0,f=d.find("g g").get(0);d.data("interval",setInterval(function(){f.setAttributeNS(null,"transform","rotate("+ ++e%a*(360/a)+")")},b*1E3/a))}}else{var v=c("<shape>").css("behavior","url(#default#VML)").appendTo("body");if(v.get(0).adj){var i=document.createStyleSheet();c.each(["group","shape","stroke"],function(){i.addRule(this,"behavior:url(#default#VML);")});r=function(d,
a){var b=a.width*2+a.space,e=(b+a.length+Math.ceil(a.width/2)+1)*2,f=-Math.ceil(e/2);f=c("<group>",{coordsize:e+" "+e,coordorigin:f+" "+f}).css({top:f,left:f,width:e,height:e});for(var j=0;j<a.segments;j++)f.append(c("<shape>",{path:"m "+b+",0  l "+(b+a.length)+",0"}).css({width:e,height:e,rotation:360/a.segments*j+"deg"}).append(c("<stroke>",{color:a.color,weight:a.width+"px",endcap:"round",opacity:c.fn.activity.getOpacity(a,j)})));return c("<group>",{coordsize:e+" "+e}).css({width:e,height:e,overflow:"hidden"}).append(f)};
t=function(d,a,b){var e=0,f=d.get(0);d.data("interval",setInterval(function(){f.style.rotation=++e%a*(360/a)},b*1E3/a))}}c(v).remove()}})(jQuery);
(function(c){function s(i,d){var a=i.data("transform");if(!a){a=new t;i.data("transform",a)}if(d!==undefined)d===false||d.reset?a.reset():a.exec(d);return a}function r(i,d){function a(b,e){return b.replace(/\{(\w+)\}/g,function(f,j){return e[j]})}this.reset=function(){c.extend(this,d)};this.format=function(){return a(i,this)};this.reset()}function t(){var i={translate:new r("translate({x}px,{y}px)",{x:0,y:0}),scale:new r("scale({x},{y})",{x:1,y:1}),rotate:new r("rotate({deg}deg)",{deg:0})};if(v){i.translate=
new r("translate3d({x}px,{y}px,0px)",{x:0,y:0});i.scale=new r("scale3d({x},{y},1)",{x:1,y:1})}var d={rotate:function(a){i.rotate.deg=a},rotateBy:function(a){i.rotate.deg+=a},scale:function(a){if(typeof a=="number")a={x:a,y:a};i.scale.x=a.x;i.scale.y=a.y},scaleBy:function(a){if(typeof a=="number")a={x:a,y:a};i.scale.x*=a.x;i.scale.y*=a.y},translate:function(a){var b=i.translate;a||(a={x:0,y:0});b.x=a.x!==undefined?parseInt(a.x,10):b.x;b.y=a.y!==undefined?parseInt(a.y,10):b.y},translateBy:function(a){var b=
i.translate;b.x+=parseInt(a.x,10)||0;b.y+=parseInt(a.y,10)||0}};this.fn=i;this.exec=function(a){for(var b in a)d[b]&&d[b](a[b])};this.reset=function(){c.each(i,function(){this.reset()})};this.format=function(){var a="";c.each(i,function(b,e){a+=e.format()+" "});return a}}var n=function(){function i(e){var f="";if(a[e]!==undefined)return e;c.each(d,function(){var j=this+e.charAt(0).toUpperCase()+e.substring(1);if(a[j]!==undefined){f=j;return false}});return f}var d=["Webkit","Moz","O"],a=document.createElement("div").style,
b={};c.each(["transitionDuration","transitionProperty","transform","transformOrigin"],function(){b[this]=i(this)});return b}(),v=function(){var i=document.createElement("div").style;try{i[n.transform]="translate3d(0,0,0)";return i[n.transform].length>0}catch(d){return false}}();c.fn.transform=function(i){var d=this;c.fn.transform.supported&&this.each(function(){var a=c(this),b=s(a,i);if(i===undefined){d=b.fn;return false}var e=i&&i.origin?i.origin:"0 0";a.css(n.transitionDuration,"0s").css(n.transformOrigin,
e).css(n.transform,b.format())});return d};c.fn.transform.supported=!!n.transform;c.fn.transition=function(i,d){d=c.extend({delay:0,duration:0.4},d);var a="";c.each(i,function(b){a+=b+","});this.each(function(){function b(){f.css(n.transitionProperty,a).css(n.transitionDuration,d.duration+"s");f.css(i);d.duration>0?f.one("webkitTransitionEnd oTransitionEnd transitionend",e):setTimeout(e,1)}function e(){f.css(n.transitionDuration,j);d.onFinish&&c.proxy(d.onFinish,f)()}var f=c(this);if(c.fn.transition.supported){var j=
f.css(n.transitionDuration);d.delay>0?setTimeout(b,d.delay):b()}else{f.css(i);d.onFinish&&c.proxy(d.onFinish,f)()}});return this};c.fn.transition.supported=!!n.transitionProperty;c.fn.transformTransition=function(i){i=c.extend({origin:"0 0",css:{}},i);var d=i.css;if(c.fn.transform.supported){d[n.transform]=s(this,i).format();this.css(n.transformOrigin,i.origin)}return this.transition(d,i)}})(jQuery);
(function(c){function s(g,h,k){h.activity();var m=new Image;m.onload=function(){h.activity(false);r(g,g.index(h),this,k.getSource)};m.src=c.proxy(k.getSource,h.get(0))()}function r(g,h,k,m){var p=f(F(c('<div id="galleryViewport">').css({position:"fixed",top:0,left:0,overflow:"hidden"}).transform(false).appendTo("body"))),q=c('<div id="galleryStripe">').css({position:"absolute",height:"100%",top:0,left:-h*w()+"px"}).width(g.length*w()).transform(false).appendTo(p);e(q,w(),h,g.length-1);c(window).bind("orientationchange.gallery",
function(){f(p);q.find("img").each(v)});g.each(function(x){var l=c("<div>").addClass("galleryPage").css({display:"block",position:"absolute",left:x*w()+"px",overflow:"hidden",height:"100%"}).width(w()).data("thumbs",g).data("thumb",c(this)).transform(false).appendTo(q);if(x==h){var u=c(k).css({position:"absolute",display:"block"}).transform(false);C(v(h,k,u)).appendTo(l);i(c(this),u,function(){q.addClass("ready");b(h)});n(p)}else{l.activity({color:"#fff"});var E=new Image,G=c.proxy(m,this)();l.one("loadImage",
function(){E.src=G});E.onload=function(){var H=c(this).css({position:"absolute",display:"block"}).transform(false);v(x,this,H).appendTo(l.activity(false));l.trigger("loaded")}}})}function t(g){if(g.is(".ready")&&!g.is(".panning")){c("#galleryShade").remove();var h=g.find(".galleryPage").eq(g.data("galleryIndex"));h.data("thumbs").removeClass("open");var k=h.data("thumb");g.add(window).add(document).unbind(".gallery");d(h.find("img"),k,function(){D(k).transform(false);c("#galleryViewport").remove()})}}
function n(g,h){var k=c('<div id="galleryShade">').css({top:0,left:0,background:"#000",opacity:0});if(z){var m=Math.max(screen.width,screen.height)*(window.devicePixelRatio||1)+Math.max(A(),o())+100;k.css({position:"absolute"}).width(m).height(m)}else k.css({position:"fixed",width:"100%",height:"100%"});k.insertBefore(g).transform(false).transition({opacity:1},{delay:200,duration:0.8,onFinish:h})}function v(g,h,k){k=k||c(h);if(!h.naturalWidth){h.naturalWidth=h.width;h.naturalHeight=h.height}g=Math.min(w()/
document.documentElement.clientWidth,Math.min(B()/h.naturalHeight,w()/h.naturalWidth));k.css({top:Math.round((B()-h.naturalHeight*g)/2)+"px",left:Math.round((w()-h.naturalWidth*g)/2)+"px"}).width(Math.round(h.naturalWidth*g));return k}function i(g,h,k){var m=y(h),p=y(g),q=Math.max(p.width/h.width(),p.height/h.height()),x=z?0:A(),l=z?0:o();h.transform({translate:{x:p.left-m.left-x-Math.round((m.width*q-p.width)/2),y:p.top-m.top-l-Math.round((m.height*q-p.height)/2)},scale:q});setTimeout(function(){D(h);
C(g);h.transformTransition({reset:true,onFinish:k})},1)}function d(g,h,k){if(g.length===0||!c.fn.transition.supported)k&&k();else{var m=y(g);h=y(h);var p=Math.min(m.height*h.width/h.height,m.width),q=Math.min(m.width*h.height/h.width,m.height),x=Math.max(h.width/p,h.height/q),l=c("<div>").css({overflow:"hidden",position:"absolute",width:p+"px",height:q+"px",top:o()+Math.round((B()-q)/2)+"px",left:A()+Math.round((w()-p)/2)+"px"}).appendTo("body").append(g.css({top:1-Math.floor((m.height-q)/2)+"px",
left:-Math.floor((m.width-p)/2)+"px"})).transform(false);m=y(l);l.transformTransition({translate:{x:h.left-m.left-Math.round((p*x-h.width)/2),y:h.top-m.top-Math.round((q*x-h.height)/2)},scale:x,onFinish:function(){k();l.remove()}})}}function a(g){return c("#galleryStripe .galleryPage").eq(g)}function b(g){function h(){a(g-1).add(a(g+1)).trigger("loadImage")}var k=a(g);k.find("img").length>0?h():k.one("loaded",h)}function e(g,h,k,m){function p(l){var u=g.data("galleryIndex");D(a(u).data("thumb"));
u=Math.max(0,Math.min(u+l,m));g.data("galleryIndex",u);C(a(u).data("thumb"));b(u);if(c.fn.transform.supported){l=-u*h-x;l!=g.transform().translate.x&&g.addClass("panning").transformTransition({translate:{x:l},onFinish:function(){this.removeClass("panning")}})}else g.css("left",-u*h+"px")}var q=w()/document.documentElement.clientWidth,x=parseInt(g.css("left"),10);g.data("galleryIndex",k);c(document).bind("keydown.gallery",function(l){if(l.keyCode==37)g.trigger("prev");else l.keyCode==39&&g.trigger("next");
if(l.keyCode==27||l.keyCode==32)g.trigger("close");return false});g.bind("touchstart",function(){c(this).data("pan",{startX:event.targetTouches[0].screenX,lastX:event.targetTouches[0].screenX,startTime:(new Date).getTime(),startOffset:c(this).transform().translate.x,distance:function(){return Math.round(q*(this.startX-this.lastX))},delta:function(){var l=event.targetTouches[0].screenX;this.dir=this.lastX>l?1:-1;var u=Math.round(q*(this.lastX-l));this.lastX=l;return u},duration:function(){return(new Date).getTime()-
this.startTime}});return false}).bind("touchmove",function(){var l=c(this).data("pan");c(this).transform({translateBy:{x:-l.delta()}});return false}).bind("touchend",function(){var l=c(this).data("pan");l.distance()===0&&l.duration()<500?c(event.target).trigger("click"):p(l.dir);return false}).bind("prev",function(){p(-1)}).bind("next",function(){p(1)}).bind("click close",function(){t(g)})}function f(g){z&&g.css({top:o()+"px",left:A()+"px"});return g.width(w()).height(B())}function j(g,h){if(window[g]!==
undefined)return window[g];var k=document.documentElement;if(k&&k[h])return k[h];return document.body[h]}function o(){return j("pageYOffset","scrollTop")}function A(){return j("pageXOffset","scrollLeft")}function w(){return j("innerWidth","clientWidth")}function B(){return j("innerHeight","clientHeight")}function D(g){return g.css("visibility","visible")}function C(g){return g.css("visibility","hidden")}function y(g){var h=g.get(0);if(h&&h.getBoundingClientRect)return h.getBoundingClientRect();return c.extend({width:g.width(),
height:g.height()},g.offset())}function F(g){return g.bind("touchstart",function(){return false})}var z=/Mobile.*Safari/.test(navigator.userAgent);c.fn.touchGallery=function(g){g=c.extend({},c.fn.touchGallery.defaults,g);var h=this;this.live("click",function(k){k.preventDefault();k=c(this);if(!k.is(".open")){h.addClass("open");s(h,k,g)}});return this};c.fn.touchGallery.defaults={getSource:function(){return this.href}}})(jQuery);
