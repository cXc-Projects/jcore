(function(b){function k(f,a){var c=document.createElementNS("http://www.w3.org/2000/svg",f||"svg");a&&b.each(a,function(a,b){c.setAttributeNS(null,a,b)});return b(c)}b.fn.activity=function(f){this.each(function(){var a=b(this),c=a.data("activity");c&&(clearInterval(c.data("interval")),c.remove(),a.removeData("activity"));if(f!==false){f=b.extend({color:a.css("color")},b.fn.activity.defaults,f);var c=j(a,f).css("position","absolute").prependTo(f.outside?"body":a),d=a.outerHeight()-c.height(),g=a.outerWidth()-
c.width(),d=f.valign=="top"?f.padding:f.valign=="bottom"?d-f.padding:Math.floor(d/2),g=f.align=="left"?f.padding:f.align=="right"?g-f.padding:Math.floor(g/2),i=a.offset();f.outside?c.css({top:i.top+"px",left:i.left+"px"}):(d-=c.offset().top-i.top,g-=c.offset().left-i.left);c.css({marginTop:d+"px",marginLeft:g+"px"});m(c,f.segments,Math.round(10/f.speed)/10);a.data("activity",c)}});return this};b.fn.activity.defaults={segments:12,space:3,length:7,width:4,speed:1.2,align:"center",valign:"center",padding:4};
b.fn.activity.getOpacity=function(b,a){var c=b.steps||b.segments-1,d=b.opacity!==void 0?b.opacity:1/c;return 1-Math.min(a,c)*(1-d)/c};var j=function(){return b("<div>").addClass("busy")},m=function(){};if(document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect)if(j=function(f,a){for(var c=a.width*2+a.space,d=c+a.length+Math.ceil(a.width/2)+1,g=k().width(d*2).height(d*2),i=k("g",{"stroke-width":a.width,"stroke-linecap":"round",stroke:a.color}).appendTo(k("g",
{transform:"translate("+d+","+d+")"}).appendTo(g)),e=0;e<a.segments;e++)i.append(k("line",{x1:0,y1:c,x2:0,y2:c+a.length,transform:"rotate("+360/a.segments*e+", 0, 0)",opacity:b.fn.activity.getOpacity(a,e)}));return b("<div>").append(g).width(2*d).height(2*d)},document.createElement("div").style.WebkitAnimationName!==void 0)var h={},m=function(b,a,c){if(!h[a]){for(var d="spin"+a,g="@-webkit-keyframes "+d+" {",e=0;e<a;e++){var j=Math.round(1E5/a*e)/1E3,k=Math.round(1E5/a*(e+1)-1)/1E3,l="% { -webkit-transform:rotate("+
Math.round(360/a*e)+"deg); }\n";g+=j+l+k+l}g+="100% { -webkit-transform:rotate(100deg); }\n}";document.styleSheets[0].insertRule(g);h[a]=d}b.css("-webkit-animation",h[a]+" "+c+"s linear infinite")};else m=function(b,a,c){var d=0,g=b.find("g g").get(0);b.data("interval",setInterval(function(){g.setAttributeNS(null,"transform","rotate("+ ++d%a*(360/a)+")")},c*1E3/a))};else{var n=b("<shape>").css("behavior","url(#default#VML)").appendTo("body");if(n.get(0).adj){var e=document.createStyleSheet();b.each(["group",
"shape","stroke"],function(){e.addRule(this,"behavior:url(#default#VML);")});j=function(f,a){for(var c=a.width*2+a.space,d=(c+a.length+Math.ceil(a.width/2)+1)*2,g=-Math.ceil(d/2),g=b("<group>",{coordsize:d+" "+d,coordorigin:g+" "+g}).css({top:g,left:g,width:d,height:d}),e=0;e<a.segments;e++)g.append(b("<shape>",{path:"m "+c+",0  l "+(c+a.length)+",0"}).css({width:d,height:d,rotation:360/a.segments*e+"deg"}).append(b("<stroke>",{color:a.color,weight:a.width+"px",endcap:"round",opacity:b.fn.activity.getOpacity(a,
e)})));return b("<group>",{coordsize:d+" "+d}).css({width:d,height:d,overflow:"hidden"}).append(g)};m=function(b,a,c){var d=0,g=b.get(0);b.data("interval",setInterval(function(){g.style.rotation=++d%a*(360/a)},c*1E3/a))}}b(n).remove()}})(jQuery);
(function(b){function k(f,a){var c=document.createElementNS("http://www.w3.org/2000/svg",f||"svg");a&&b.each(a,function(a,b){c.setAttributeNS(null,a,b)});return b(c)}b.fn.activity=function(f){this.each(function(){var a=b(this),c=a.data("activity");c&&(clearInterval(c.data("interval")),c.remove(),a.removeData("activity"));if(f!==false){f=b.extend({color:a.css("color")},b.fn.activity.defaults,f);var c=j(a,f).css("position","absolute").prependTo(f.outside?"body":a),d=Math.floor((a.outerHeight()-c.height())/
2),e=Math.floor((a.outerWidth()-c.width())/2),i=a.offset();f.outside?c.css({top:i.top+"px",left:i.left+"px"}):(d-=c.offset().top-i.top,e-=c.offset().left-i.left);c.css({marginTop:d+"px",marginLeft:e+"px"});m(c,f.segments,Math.round(10/f.speed)/10);a.data("activity",c)}});return this};b.fn.activity.defaults={segments:12,space:3,length:7,width:4,speed:1.2};b.fn.activity.getOpacity=function(b,a){var c=b.steps||b.segments-1,d=b.opacity!==void 0?b.opacity:1/c;return 1-Math.min(a,c)*(1-d)/c};var j=function(){return b("<div>").addClass("busy")},
m=function(){};if(document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect)if(j=function(f,a){for(var c=a.width*2+a.space,d=c+a.length+Math.ceil(a.width/2)+1,e=k().width(d*2).height(d*2),i=k("g",{"stroke-width":a.width,"stroke-linecap":"round",stroke:a.color}).appendTo(k("g",{transform:"translate("+d+","+d+")"}).appendTo(e)),h=0;h<a.segments;h++)i.append(k("line",{x1:0,y1:c,x2:0,y2:c+a.length,transform:"rotate("+360/a.segments*h+", 0, 0)",opacity:b.fn.activity.getOpacity(a,
h)}));return b("<div>").append(e).width(2*d).height(2*d)},document.createElement("div").style.WebkitAnimationName!==void 0)var h={},m=function(b,a,c){if(!h[a]){for(var d="spin"+a,e="@-webkit-keyframes "+d+" {",i=0;i<a;i++){var j=Math.round(1E5/a*i)/1E3,k=Math.round(1E5/a*(i+1)-1)/1E3,l="% { -webkit-transform:rotate("+Math.round(360/a*i)+"deg); }\n";e+=j+l+k+l}e+="100% { -webkit-transform:rotate(100deg); }\n}";document.styleSheets[0].insertRule(e);h[a]=d}b.css("-webkit-animation",h[a]+" "+c+"s linear infinite")};
else m=function(b,a,c){var d=0,e=b.find("g g").get(0);b.data("interval",setInterval(function(){e.setAttributeNS(null,"transform","rotate("+ ++d%a*(360/a)+")")},c*1E3/a))};else{var n=b("<shape>").css("behavior","url(#default#VML)").appendTo("body");if(n.get(0).adj){var e=document.createStyleSheet();b.each(["group","shape","stroke"],function(){e.addRule(this,"behavior:url(#default#VML);")});j=function(e,a){for(var c=a.width*2+a.space,d=(c+a.length+Math.ceil(a.width/2)+1)*2,g=-Math.ceil(d/2),g=b("<group>",
{coordsize:d+" "+d,coordorigin:g+" "+g}).css({top:g,left:g,width:d,height:d}),i=0;i<a.segments;i++)g.append(b("<shape>",{path:"m "+c+",0  l "+(c+a.length)+",0"}).css({width:d,height:d,rotation:360/a.segments*i+"deg"}).append(b("<stroke>",{color:a.color,weight:a.width+"px",endcap:"round",opacity:b.fn.activity.getOpacity(a,i)})));return b("<group>",{coordsize:d+" "+d}).css({width:d,height:d,overflow:"hidden"}).append(g)};m=function(b,a,c){var d=0,e=b.get(0);b.data("interval",setInterval(function(){e.style.rotation=
++d%a*(360/a)},c*1E3/a))}}b(n).remove()}})(jQuery);
(function(b){function k(b,f){var a=b.data("transform");a||(a=new m,b.data("transform",a));f!==void 0&&(f===false||f.reset?a.reset():a.exec(f));return a}function j(e,f){function a(a,b){return a.replace(/\{(\w+)\}/g,function(a,c){return b[c]})}this.reset=function(){b.extend(this,f)};this.format=function(){return a(e,this)};this.reset()}function m(){var e={translate:new j("translate({x}px,{y}px)",{x:0,y:0}),scale:new j("scale({x},{y})",{x:1,y:1}),rotate:new j("rotate({deg}deg)",{deg:0})};if(n)e.translate=
new j("translate3d({x}px,{y}px,0px)",{x:0,y:0}),e.scale=new j("scale3d({x},{y},1)",{x:1,y:1});var f={rotate:function(a){e.rotate.deg=a},rotateBy:function(a){e.rotate.deg+=a},scale:function(a){typeof a=="number"&&(a={x:a,y:a});e.scale.x=a.x;e.scale.y=a.y},scaleBy:function(a){typeof a=="number"&&(a={x:a,y:a});e.scale.x*=a.x;e.scale.y*=a.y},translate:function(a){var b=e.translate;a||(a={x:0,y:0});b.x=a.x!==void 0?parseInt(a.x,10):b.x;b.y=a.y!==void 0?parseInt(a.y,10):b.y},translateBy:function(a){var b=
e.translate;b.x+=parseInt(a.x,10)||0;b.y+=parseInt(a.y,10)||0}};this.fn=e;this.exec=function(a){for(var b in a)if(f[b])f[b](a[b])};this.reset=function(){b.each(e,function(){this.reset()})};this.format=function(){var a="";b.each(e,function(b,d){a+=d.format()+" "});return a}}var h=function(){function e(c){var e="";if(a[c]!==void 0)return c;b.each(f,function(){var b=this+c.charAt(0).toUpperCase()+c.substring(1);if(a[b]!==void 0)return e=b,false});return e}var f=["Webkit","Moz","O"],a=document.createElement("div").style,
c={};b.each(["transitionDuration","transitionProperty","transform","transformOrigin"],function(){c[this]=e(this)});return c}(),n=function(){var b=document.createElement("div").style;try{return b[h.transform]="translate3d(0,0,0)",b[h.transform].length>0}catch(f){return false}}();b.fn.transform=function(e){var f=this;b.fn.transform.supported&&this.each(function(){var a=b(this),c=k(a,e);if(e===void 0)return f=c.fn,false;var d=e&&e.origin?e.origin:"0 0";a.css(h.transitionDuration,"0s").css(h.transformOrigin,
d).css(h.transform,c.format())});return f};b.fn.transform.supported=!!h.transform;b.fn.transition=function(e,f){var f=b.extend({delay:0,duration:0.4},f),a="";b.each(e,function(b){a+=b+","});this.each(function(){function c(){g.css(h.transitionProperty,a).css(h.transitionDuration,f.duration+"s");g.css(e);if(f.duration>0)g.one("webkitTransitionEnd oTransitionEnd transitionend",d);else setTimeout(d,1)}function d(){g.css(h.transitionDuration,i);f.onFinish&&b.proxy(f.onFinish,g)()}var g=b(this);if(b.fn.transition.supported){var i=
g.css(h.transitionDuration);f.delay>0?setTimeout(c,f.delay):c()}else g.css(e),f.onFinish&&b.proxy(f.onFinish,g)()});return this};b.fn.transition.supported=!!h.transitionProperty;b.fn.transformTransition=function(e){var e=b.extend({origin:"0 0",css:{}},e),f=e.css;b.fn.transform.supported&&(f[h.transform]=k(this,e).format(),this.css(h.transformOrigin,e.origin));return this.transition(f,e)}})(jQuery);
(function(b){function k(a,c,e){c.activity();var d=new Image;d.onload=function(){c.activity(false);j(a,a.index(c),this,e.getSource)};d.src=b.proxy(e.getSource,c.get(0))()}function j(a,f,w,i){var t=g(x(b('<div id="galleryViewport">').css({position:"fixed",top:0,left:0,overflow:"hidden"}).transform(false).appendTo("body"))),j=b('<div id="galleryStripe">').css({position:"absolute",height:"100%",top:0,left:-f*l()+"px"}).width(a.length*l()).transform(false).appendTo(t);d(j,l(),f,a.length-1);b(window).bind("orientationchange.gallery",
function(){g(t);j.find("img").each(n)});a.each(function(d){var g=b("<div>").addClass("galleryPage").css({display:"block",position:"absolute",left:d*l()+"px",overflow:"hidden",height:"100%"}).width(l()).data("thumbs",a).data("thumb",b(this)).transform(false).appendTo(j);if(d==f){var k=b(w).css({position:"absolute",display:"block"}).transform(false);u(n(f,w,k)).appendTo(g);e(b(this),k,function(){j.addClass("ready");c(f)});h(t)}else{g.activity({color:"#fff"});var m=new Image,o=b.proxy(i,this)();g.one("loadImage",
function(){m.src=o});m.onload=function(){var a=b(this).css({position:"absolute",display:"block"}).transform(false);n(d,this,a).appendTo(g.activity(false));g.trigger("loaded")}}})}function m(a){if(a.is(".ready")&&!a.is(".panning")){b("#galleryShade").remove();var c=a.find(".galleryPage").eq(a.data("galleryIndex"));c.data("thumbs").removeClass("open");var d=c.data("thumb");a.add(window).add(document).unbind(".gallery");f(c.find("img"),d,function(){v(d).transform(false);b("#galleryViewport").remove()})}}
function h(a,c){var d=b('<div id="galleryShade">').css({top:0,left:0,background:"#000",opacity:0});if(r){var e=Math.max(screen.width,screen.height)*(window.devicePixelRatio||1)+Math.max(q(),p())+100;d.css({position:"absolute"}).width(e).height(e)}else d.css({position:"fixed",width:"100%",height:"100%"});d.insertBefore(a).transform(false).transition({opacity:1},{delay:200,duration:0.8,onFinish:c})}function n(a,c,d){d=d||b(c);if(!c.naturalWidth)c.naturalWidth=c.width,c.naturalHeight=c.height;a=Math.min(l()/
document.documentElement.clientWidth,Math.min(s()/c.naturalHeight,l()/c.naturalWidth));d.css({top:Math.round((s()-c.naturalHeight*a)/2)+"px",left:Math.round((l()-c.naturalWidth*a)/2)+"px"}).width(Math.round(c.naturalWidth*a));return d}function e(a,b,c){var d=o(b),e=o(a),f=Math.max(e.width/b.width(),e.height/b.height()),g=r?0:q(),i=r?0:p();b.transform({translate:{x:e.left-d.left-g-Math.round((d.width*f-e.width)/2),y:e.top-d.top-i-Math.round((d.height*f-e.height)/2)},scale:f});setTimeout(function(){v(b);
u(a);b.transformTransition({reset:true,onFinish:c})},1)}function f(a,c,d){if(a.length===0||!b.fn.transition.supported)d&&d();else{var e=o(a),c=o(c),f=Math.min(e.height*c.width/c.height,e.width),g=Math.min(e.width*c.height/c.width,e.height),i=Math.max(c.width/f,c.height/g),h=b("<div>").css({overflow:"hidden",position:"absolute",width:f+"px",height:g+"px",top:p()+Math.round((s()-g)/2)+"px",left:q()+Math.round((l()-f)/2)+"px"}).appendTo("body").append(a.css({top:1-Math.floor((e.height-g)/2)+"px",left:-Math.floor((e.width-
f)/2)+"px"})).transform(false),e=o(h);h.transformTransition({translate:{x:c.left-e.left-Math.round((f*i-c.width)/2),y:c.top-e.top-Math.round((g*i-c.height)/2)},scale:i,onFinish:function(){d();h.remove()}})}}function a(a){return b("#galleryStripe .galleryPage").eq(a)}function c(b){function c(){a(b-1).add(a(b+1)).trigger("loadImage")}var d=a(b);if(d.find("img").length>0)c();else d.one("loaded",c)}function d(d,e,f,g){function i(f){var h=d.data("galleryIndex");v(a(h).data("thumb"));h=Math.max(0,Math.min(h+
f,g));d.data("galleryIndex",h);u(a(h).data("thumb"));c(h);b.fn.transform.supported?(f=-h*e-j,f!=d.transform().translate.x&&d.addClass("panning").transformTransition({translate:{x:f},onFinish:function(){this.removeClass("panning")}})):d.css("left",-h*e+"px")}var h=l()/document.documentElement.clientWidth,j=parseInt(d.css("left"),10);d.data("galleryIndex",f);b(document).bind("keydown.gallery",function(a){a.keyCode==37?d.trigger("prev"):a.keyCode==39&&d.trigger("next");(a.keyCode==27||a.keyCode==32)&&
d.trigger("close");return false});d.bind("touchstart",function(){b(this).data("pan",{startX:event.targetTouches[0].screenX,lastX:event.targetTouches[0].screenX,startTime:(new Date).getTime(),startOffset:b(this).transform().translate.x,distance:function(){return Math.round(h*(this.startX-this.lastX))},delta:function(){var a=event.targetTouches[0].screenX;this.dir=this.lastX>a?1:-1;var b=Math.round(h*(this.lastX-a));this.lastX=a;return b},duration:function(){return(new Date).getTime()-this.startTime}});
return false}).bind("touchmove",function(){var a=b(this).data("pan");b(this).transform({translateBy:{x:-a.delta()}});return false}).bind("touchend",function(){var a=b(this).data("pan");a.distance()===0&&a.duration()<500?b(event.target).trigger("click"):i(a.dir);return false}).bind("prev",function(){i(-1)}).bind("next",function(){i(1)}).bind("click close",function(){m(d)})}function g(a){r&&a.css({top:p()+"px",left:q()+"px"});return a.width(l()).height(s())}function i(a,b){if(window[a]!==void 0)return window[a];
var c=document.documentElement;return c&&c[b]?c[b]:document.body[b]}function p(){return i("pageYOffset","scrollTop")}function q(){return i("pageXOffset","scrollLeft")}function l(){return i("innerWidth","clientWidth")}function s(){return i("innerHeight","clientHeight")}function v(a){return a.css("visibility","visible")}function u(a){return a.css("visibility","hidden")}function o(a){var c=a.get(0);return c&&c.getBoundingClientRect?c.getBoundingClientRect():b.extend({width:a.width(),height:a.height()},
a.offset())}function x(a){return a.bind("touchstart",function(){return false})}var r=/Mobile.*Safari/.test(navigator.userAgent);b.fn.touchGallery=function(a){var a=b.extend({},b.fn.touchGallery.defaults,a),c=this;this.live("click",function(d){d.preventDefault();d=b(this);d.is(".open")||(c.addClass("open"),k(c,d,a))});return this};b.fn.touchGallery.defaults={getSource:function(){return this.href}}})(jQuery);
