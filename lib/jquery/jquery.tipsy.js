(function(c){function j(a,b){this.$element=c(a);this.options=b;this.enabled=true;this.fixTitle()}j.prototype={show:function(){var a=this.getTitle();if(a&&this.enabled){var b=this.tip();b.find(".tipsy-inner")[this.options.html?"html":"text"](a);b[0].className="tipsy";b.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);this.update();this.options.fade?b.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):b.css({visibility:"visible",
opacity:this.options.opacity})}},update:function(){if(this.enabled){var a=this.tip();a[0].className="tipsy"+(this.options.additionalClassName!=""?" "+this.options.additionalClassName:"");var b=c.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),e=a[0].offsetWidth,h=a[0].offsetHeight,f=typeof this.options.gravity=="function"?this.options.gravity.call(this.$element[0]):this.options.gravity,g;switch(f.charAt(0)){case "n":g={top:b.top+b.height+
this.options.offset,left:b.left+b.width/2-e/2};break;case "s":g={top:b.top-h-this.options.offset,left:b.left+b.width/2-e/2};break;case "e":g={top:b.top+b.height/2-h/2,left:b.left-e-this.options.offset};break;case "w":g={top:b.top+b.height/2-h/2,left:b.left+b.width+this.options.offset}}if(f.length==2)g.left=f.charAt(1)=="w"?b.left+b.width/2-15:b.left+b.width/2-e+15;if(g.left<0)g.left=0;a.css(g).addClass("tipsy-"+f)}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){c(this).remove()}):
this.tip().remove()},fixTitle:function(){var a=this.$element;if(a.attr("title")||typeof a.attr("original-title")!="string")a.attr("original-title",a.attr("title")||"").removeAttr("title")},getTitle:function(){var a,b=this.$element,e=this.options;this.fixTitle();e=this.options;if(typeof e.title=="string")a=b.attr(e.title=="title"?"original-title":e.title);else if(typeof e.title=="function")a=e.title.call(b[0]);return(a=(""+a).replace(/(^\s*|\s*$)/,""))||e.fallback},tip:function(){if(!this.$tip)this.$tip=
c('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-outer">'+(this.options.closeButton?'<div class="tipsy-close-button"><a href="javascript://" onclick="jQuery(this).closest(\'.tipsy\').hide()"><span>x</span></a></div>':"")+'<div class="tipsy-inner"></div></div>');return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();this.options=this.$element=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=
!this.enabled}};c.fn.tipsy=function(a){function b(d){var i=c.data(d,"tipsy");if(!i){i=new j(d,c.fn.tipsy.elementOptions(d,a));c.data(d,"tipsy",i)}return i}function e(){var d=b(this);d.hoverState="in";if(a.delayIn==0)d.show();else{d.fixTitle();setTimeout(function(){d.hoverState=="in"&&d.show()},a.delayIn)}}function h(){var d=b(this);d.hoverState="out";a.delayOut==0?d.hide():setTimeout(function(){d.hoverState=="out"&&d.hide()},a.delayOut)}if(a===true)return this.data("tipsy");else if(typeof a=="string"){var f=
this.data("tipsy");f&&f[a]();return this}a=c.extend({},c.fn.tipsy.defaults,a);a.live||this.each(function(){b(this)});if(a.trigger!="manual"){f=a.live?"live":"bind";var g=a.trigger=="hover"?"mouseleave":"blur";this[f](a.trigger=="hover"?"mouseenter":"focus",e)[f](g,h)}return this};c.fn.tipsy.defaults={delayIn:0,delayOut:0,fade:false,fallback:"",additionalClassName:"",gravity:"n",html:false,live:false,offset:0,opacity:0.8,title:"title",trigger:"hover",closeButton:false};c.fn.tipsy.elementOptions=function(a,
b){return c.metadata?c.extend({},b,c(a).metadata()):b};c.fn.tipsy.autoNS=function(){return c(this).offset().top>c(document).scrollTop()+c(window).height()/2?"s":"n"};c.fn.tipsy.autoWE=function(){return c(this).offset().left>c(document).scrollLeft()+c(window).width()/2?"e":"w"}})(jQuery);
