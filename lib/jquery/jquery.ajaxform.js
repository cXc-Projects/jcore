(function(b){function n(){if(b.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(a):window.opera&&window.opera.postError&&window.opera.postError(a)}}b.fn.ajaxSubmit=function(a){function c(){function d(){var a=j.attr("target"),k=j.attr("action");c.setAttribute("target",g);c.getAttribute("method")!="POST"&&c.setAttribute("method","POST");c.getAttribute("action")!=f.url&&c.setAttribute("action",f.url);f.skipEncodingOverride||
j.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});f.timeout&&setTimeout(function(){r=!0;e()},f.timeout);var l=[];try{if(f.extraData)for(var m in f.extraData)l.push(b('<input type="hidden" name="'+m+'" value="'+f.extraData[m]+'" />').appendTo(c)[0]);h.appendTo("body");i.attachEvent?i.attachEvent("onload",e):i.addEventListener("load",e,!1);c.submit()}finally{c.setAttribute("action",k),a?c.setAttribute("target",a):j.removeAttr("target"),b(l).remove()}}function e(){if(!k.aborted&&
(b.browser.opera?m=i.document?i.document:i.contentWindow?i.contentWindow.document:i.contentDocument:m=i.contentWindow?i.contentWindow.document:i.contentDocument?i.contentDocument:i.document,m&&m.location.href!=f.iframeSrc)){i.detachEvent?i.detachEvent("onload",e):i.removeEventListener("load",e,!1);var a=!0;try{if(r)throw"timeout";var d=f.dataType=="xml"||m.XMLDocument||b.isXMLDoc(m);n("isXml="+d);if(!d&&window.opera&&(m.body==null||m.body.innerHTML=="")&&--t){n("requeing onLoad callback, DOM not available");
setTimeout(e,250);return}k.responseText=m.body?m.body.innerHTML:m.documentElement?m.documentElement.innerHTML:null;k.responseXML=m.XMLDocument?m.XMLDocument:m;k.getResponseHeader=function(a){return{"content-type":f.dataType}[a]};var c=/(json|script)/.test(f.dataType);if(c||f.textarea){var g=m.getElementsByTagName("textarea")[0];if(g)k.responseText=g.value;else if(c){var j=m.getElementsByTagName("pre")[0],o=m.getElementsByTagName("body")[0];if(j)k.responseText=j.textContent;else if(o)k.responseText=
o.innerHTML}}else if(f.dataType=="xml"&&!k.responseXML&&k.responseText!=null)k.responseXML=u(k.responseText);s=v(k,f.dataType,f)}catch(p){n("error caught:",p),a=!1,k.error=p,f.error&&f.error.call(f.context,k,"error",p),l&&b.event.trigger("ajaxError",[k,f,p])}k.aborted&&(n("upload aborted"),a=!1);a&&(f.success&&f.success.call(f.context,s,"success",k),l&&b.event.trigger("ajaxSuccess",[k,f]));l&&b.event.trigger("ajaxComplete",[k,f]);l&&!--b.active&&b.event.trigger("ajaxStop");f.complete&&f.complete.call(f.context,
k,a?"success":"error");setTimeout(function(){h.removeData("form-plugin-onload");h.remove();k.responseXML=null},100)}}var c=j[0];if(b(":input[name=submit],:input[id=submit]",c).length)alert('Error: Form elements must not have name or id of "submit".');else{var f=b.extend(!0,{},b.ajaxSettings,a);f.context=f.context||f;var g="jqFormIO"+(new Date).getTime(),h=b('<iframe id="'+g+'" name="'+g+'" src="'+f.iframeSrc+'" />'),i=h[0];h.css({position:"absolute",top:"-1000px",left:"-1000px"});var k={aborted:0,
responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){n("aborting upload...");this.aborted=1;h.attr("src",f.iframeSrc);k.error="aborted";f.error&&f.error.call(f.context,k,"error","aborted");l&&b.event.trigger("ajaxError",[k,f,"aborted"]);f.complete&&f.complete.call(f.context,k,"error")}},l=f.global;l&&!b.active++&&b.event.trigger("ajaxStart");l&&b.event.trigger("ajaxSend",[k,f]);
if(f.beforeSend&&f.beforeSend.call(f.context,k,f)===!1)f.global&&b.active--;else if(!k.aborted){var r=0,o=c.clk;if(o){var q=o.name;if(q&&!o.disabled&&(f.extraData=f.extraData||{},f.extraData[q]=o.value,o.type=="image"))f.extraData[q+".x"]=c.clk_x,f.extraData[q+".y"]=c.clk_y}f.forceSync?d():setTimeout(d,10);var s,m,t=50,u=b.parseXML||function(a,b){window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml");return b&&b.documentElement&&
b.documentElement.nodeName!="parsererror"?b:null},w=b.parseJSON||function(a){return window.eval("("+a+")")},v=function(a,e,d){var c=a.getResponseHeader("content-type")||"",f=e==="xml"||!e&&c.indexOf("xml")>=0,a=f?a.responseXML:a.responseText;f&&a.documentElement.nodeName==="parsererror"&&b.error&&b.error("parsererror");d&&d.dataFilter&&(a=d.dataFilter(a,e));typeof a==="string"&&(e==="json"||!e&&c.indexOf("json")>=0?a=w(a):(e==="script"||!e&&c.indexOf("javascript")>=0)&&b.globalEval(a));return a}}}}
if(!this.length)return n("ajaxSubmit: skipping submit process - no element selected"),this;typeof a=="function"&&(a={success:a});var e=this.attr("action");(e=typeof e==="string"?b.trim(e):"")&&(e=(e.match(/^([^#]+)/)||[])[1]);e=e||window.location.href||"";e+=e.indexOf("?")==-1?"?ajax=1":"&ajax=1";a=b.extend(!0,{url:e,type:this[0].getAttribute("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);e={};this.trigger("form-pre-serialize",[this,a,e]);
if(e.veto)return n("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&a.beforeSerialize(this,a)===!1)return n("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var d,h,g=this.formToArray(a.semantic);if(a.data)for(d in a.extraData=a.data,a.data)if(a.data[d]instanceof Array)for(var i in a.data[d])g.push({name:d,value:a.data[d][i]});else h=a.data[d],h=b.isFunction(h)?h():h,g.push({name:d,value:h});if(a.beforeSubmit&&a.beforeSubmit(g,this,a)===!1)return n("ajaxSubmit: submit aborted via beforeSubmit callback"),
this;this.trigger("form-submit-validate",[g,this,a,e]);if(e.veto)return n("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;d=b.param(g);a.type.toUpperCase()=="GET"?(a.url+=(a.url.indexOf("?")>=0?"&":"?")+d,a.data=null):a.data=d;if(typeof a.target=="undefined")a.target=jQuery(this).attr("target");var j=this,l=[];a.resetForm&&l.push(function(){j.resetForm()});a.clearForm&&l.push(function(){j.clearForm()});if(!a.dataType&&a.target){var r=a.success||function(){};l.push(function(e){var d=
a.replaceTarget?"replaceWith":"html";b(a.target)[d](e).each(r,arguments);b(a.target).jCore()})}else a.success&&l.push(a.success);a.success=function(b,e,d){a.target||(jQuery.loading(!1),jQuery.loading(!0,{html:b,text:"",max:5E3}));for(var c=a.context||a,g=0,h=l.length;g<h;g++)l[g].apply(c,[b,e,d||j,j])};d=b("input:file",this).length>0;i=j.attr("enctype")=="multipart/form-data"||j.attr("encoding")=="multipart/form-data";a.iframe!==!1&&(d||a.iframe||i)?a.closeKeepAlive?b.get(a.closeKeepAlive,c):c():
b.ajax(a);this.trigger("form-submit-notify",[this,a]);return this};b.fn.ajaxForm=function(a){if(this.length===0){var c={s:this.selector,c:this.context};if(!b.isReady&&c.s)return n("DOM not ready, queuing ajaxForm"),b(function(){b(c.s,c.c).ajaxForm(a)}),this;n("terminating; zero elements found by selector"+(b.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(e){e.isDefaultPrevented()||(e.preventDefault(),b(this).ajaxSubmit(a))}).bind("click.form-plugin",
function(a){var d=a.target,c=b(d);if(!c.is(":submit,input:image")){d=c.closest(":submit");if(d.length==0)return;d=d[0]}var g=this;g.clk=d;if(d.type=="image")a.offsetX!=void 0?(g.clk_x=a.offsetX,g.clk_y=a.offsetY):typeof b.fn.offset=="function"?(c=c.offset(),g.clk_x=a.pageX-c.left,g.clk_y=a.pageY-c.top):(g.clk_x=a.pageX-d.offsetLeft,g.clk_y=a.pageY-d.offsetTop);setTimeout(function(){g.clk=g.clk_x=g.clk_y=null},100)})};b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};
b.fn.formToArray=function(a){var c=[];if(this.length===0)return c;var e=this[0],d=a?e.getElementsByTagName("*"):e.elements;if(!d)return c;var h,g,i,j,l,n;h=0;for(l=d.length;h<l;h++)if(g=d[h],i=g.name)if(a&&e.clk&&g.type=="image")!g.disabled&&e.clk==g&&(c.push({name:i,value:b(g).val()}),c.push({name:i+".x",value:e.clk_x},{name:i+".y",value:e.clk_y}));else if((j=b.fieldValue(g,!0))&&j.constructor==Array){g=0;for(n=j.length;g<n;g++)c.push({name:i,value:j[g]})}else j!==null&&typeof j!="undefined"&&c.push({name:i,
value:j});if(!a&&e.clk&&(a=b(e.clk),d=a[0],(i=d.name)&&!d.disabled&&d.type=="image"))c.push({name:i,value:a.val()}),c.push({name:i+".x",value:e.clk_x},{name:i+".y",value:e.clk_y});return c};b.fn.formSerialize=function(a){return b.param(this.formToArray(a))};b.fn.fieldSerialize=function(a){var c=[];this.each(function(){var e=this.name;if(e){var d=b.fieldValue(this,a);if(d&&d.constructor==Array)for(var h=0,g=d.length;h<g;h++)c.push({name:e,value:d[h]});else d!==null&&typeof d!="undefined"&&c.push({name:this.name,
value:d})}});return b.param(c)};b.fn.fieldValue=function(a){for(var c=[],e=0,d=this.length;e<d;e++){var h=b.fieldValue(this[e],a);h===null||typeof h=="undefined"||h.constructor==Array&&!h.length||(h.constructor==Array?b.merge(c,h):c.push(h))}return c};b.fieldValue=function(a,c){var e=a.name,d=a.type,h=a.tagName.toLowerCase();c===void 0&&(c=!0);if(c&&(!e||a.disabled||d=="reset"||d=="button"||(d=="checkbox"||d=="radio")&&!a.checked||(d=="submit"||d=="image")&&a.form&&a.form.clk!=a||h=="select"&&a.selectedIndex==
-1))return null;if(h=="select"){var g=a.selectedIndex;if(g<0)return null;for(var e=[],h=a.options,i=(d=d=="select-one")?g+1:h.length,g=d?g:0;g<i;g++){var j=h[g];if(j.selected){var l=j.value;l||(l=j.attributes&&j.attributes.value&&!j.attributes.value.specified?j.text:j.value);if(d)return l;e.push(l)}}return e}return b(a).val()};b.fn.clearForm=function(){return this.each(function(){b("input,select,textarea",this).clearFields()})};b.fn.clearFields=b.fn.clearInputs=function(){return this.each(function(){var a=
this.type,b=this.tagName.toLowerCase();if(a=="text"||a=="password"||b=="textarea")this.value="";else if(a=="checkbox"||a=="radio")this.checked=!1;else if(b=="select")this.selectedIndex=-1})};b.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})};b.fn.enable=function(a){a===void 0&&(a=!0);return this.each(function(){this.disabled=!a})};b.fn.selected=function(a){a===void 0&&(a=!0);return this.each(function(){var c=
this.type;if(c=="checkbox"||c=="radio")this.checked=a;else if(this.tagName.toLowerCase()=="option")c=b(this).parent("select"),a&&c[0]&&c[0].type=="select-one"&&c.find("option").selected(!1),this.selected=a})}})(jQuery);
