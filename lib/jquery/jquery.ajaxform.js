(function(c){function m(){if(c.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(a):window.opera&&window.opera.postError&&window.opera.postError(a)}}c.fn.ajaxSubmit=function(a){function f(b){function f(){function a(){try{var b=(n.contentWindow?n.contentWindow.document:n.contentDocument?n.contentDocument:n.document).readyState;m("state = "+b);b.toLowerCase()=="uninitialized"&&setTimeout(a,50)}catch(c){m("Server abort: ",
c," (",c.name,")"),i(v),s&&clearTimeout(s),s=void 0}}var b=j.attr("target"),g=j.attr("action");e.setAttribute("target",p);k||e.setAttribute("method","POST");g!=d.url&&e.setAttribute("action",d.url);!d.skipEncodingOverride&&(!k||/post/i.test(k))&&j.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});d.timeout&&(s=setTimeout(function(){t=true;i(w)},d.timeout));var h=[];try{if(d.extraData)for(var l in d.extraData)h.push(c('<input type="hidden" name="'+l+'" />').attr("value",d.extraData[l]).appendTo(e)[0]);
d.iframeTarget||(q.appendTo("body"),n.attachEvent?n.attachEvent("onload",i):n.addEventListener("load",i,false));setTimeout(a,15);e.submit()}finally{e.setAttribute("action",g),b?e.setAttribute("target",b):j.removeAttr("target"),c(h).remove()}}function i(a){if(!g.aborted&&!x){try{o=n.contentWindow?n.contentWindow.document:n.contentDocument?n.contentDocument:n.document}catch(b){m("cannot access response document: ",b),a=v}if(a===w&&g)g.abort("timeout");else if(a==v&&g)g.abort("server abort");else if(o&&
o.location.href!=d.iframeSrc||t){n.detachEvent?n.detachEvent("onload",i):n.removeEventListener("load",i,false);var a="success",e;try{if(t)throw"timeout";var j=d.dataType=="xml"||o.XMLDocument||c.isXMLDoc(o);m("isXml="+j);if(!j&&window.opera&&(o.body==null||o.body.innerHTML=="")&&--B){m("requeing onLoad callback, DOM not available");setTimeout(i,250);return}var f=o.body?o.body:o.documentElement;g.responseText=f?f.innerHTML:null;g.responseXML=o.XMLDocument?o.XMLDocument:o;if(j)d.dataType="xml";g.getResponseHeader=
function(a){return{"content-type":d.dataType}[a]};if(f)g.status=Number(f.getAttribute("status"))||g.status,g.statusText=f.getAttribute("statusText")||g.statusText;var h=(d.dataType||"").toLowerCase(),k=/(json|script|text)/.test(h);if(k||d.textarea){var l=o.getElementsByTagName("textarea")[0];if(l)g.responseText=l.value,g.status=Number(l.getAttribute("status"))||g.status,g.statusText=l.getAttribute("statusText")||g.statusText;else if(k){var p=o.getElementsByTagName("pre")[0],u=o.getElementsByTagName("body")[0];
if(p)g.responseText=p.textContent?p.textContent:p.innerText;else if(u)g.responseText=u.textContent?u.textContent:u.innerText}}else if(h=="xml"&&!g.responseXML&&g.responseText!=null)g.responseXML=C(g.responseText);try{y=D(g,h,d)}catch(A){a="parsererror",g.error=e=A||a}}catch(z){m("error caught: ",z),a="error",g.error=e=z||a}g.aborted&&(m("upload aborted"),a=null);g.status&&(a=g.status>=200&&g.status<300||g.status===304?"success":"error");if(a==="success")d.success&&d.success.call(d.context,y,"success",
g),r&&c.event.trigger("ajaxSuccess",[g,d]);else if(a){if(e==void 0)e=g.statusText;d.error&&d.error.call(d.context,g,a,e);r&&c.event.trigger("ajaxError",[g,d,e])}r&&c.event.trigger("ajaxComplete",[g,d]);r&&!--c.active&&c.event.trigger("ajaxStop");d.complete&&d.complete.call(d.context,g,a);x=true;d.timeout&&clearTimeout(s);setTimeout(function(){d.iframeTarget||q.remove();g.responseXML=null},100)}}}var e=j[0],h,l,d,r,p,q,n,g,t,s;h=!!c.fn.prop;if(b)if(h)for(l=0;l<b.length;l++)h=c(e[b[l].name]),h.prop("disabled",
false);else for(l=0;l<b.length;l++)h=c(e[b[l].name]),h.removeAttr("disabled");if(c(":input[name=submit],:input[id=submit]",e).length)alert('Error: Form elements must not have name or id of "submit".');else if(d=c.extend(true,{},c.ajaxSettings,a),d.context=d.context||d,p="jqFormIO"+(new Date).getTime(),d.iframeTarget?(q=c(d.iframeTarget),h=q.attr("name"),h==null?q.attr("name",p):p=h):(q=c('<iframe name="'+p+'" src="'+d.iframeSrc+'" />'),q.css({position:"absolute",top:"-1000px",left:"-1000px"})),n=
q[0],g={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(a){var b=a==="timeout"?"timeout":"aborted";m("aborting upload... "+b);this.aborted=1;q.attr("src",d.iframeSrc);g.error=b;d.error&&d.error.call(d.context,g,b,a);r&&c.event.trigger("ajaxError",[g,d,b]);d.complete&&d.complete.call(d.context,g,b)}},(r=d.global)&&!c.active++&&c.event.trigger("ajaxStart"),r&&c.event.trigger("ajaxSend",
[g,d]),d.beforeSend&&d.beforeSend.call(d.context,g,d)===false)d.global&&c.active--;else if(!g.aborted){if(b=e.clk)if((h=b.name)&&!b.disabled)if(d.extraData=d.extraData||{},d.extraData[h]=b.value,b.type=="image")d.extraData[h+".x"]=e.clk_x,d.extraData[h+".y"]=e.clk_y;var w=1,v=2;d.forceSync?f():setTimeout(f,10);var y,o,B=50,x,C=c.parseXML||function(a,b){window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml");return b&&
b.documentElement&&b.documentElement.nodeName!="parsererror"?b:null},E=c.parseJSON||function(a){return window.eval("("+a+")")},D=function(a,b,d){var e=a.getResponseHeader("content-type")||"",g=b==="xml"||!b&&e.indexOf("xml")>=0,a=g?a.responseXML:a.responseText;g&&a.documentElement.nodeName==="parsererror"&&c.error&&c.error("parsererror");d&&d.dataFilter&&(a=d.dataFilter(a,b));typeof a==="string"&&(b==="json"||!b&&e.indexOf("json")>=0?a=E(a):(b==="script"||!b&&e.indexOf("javascript")>=0)&&c.globalEval(a));
return a}}}if(!this.length)return m("ajaxSubmit: skipping submit process - no element selected"),this;var k,b,j=this;typeof a=="function"&&(a={success:a});k=this.attr("method");b=this.attr("action");(b=(b=typeof b==="string"?c.trim(b):"")||window.location.href||"")&&(b=(b.match(/^([^#]+)/)||[])[1]);b=b.indexOf("?")==-1?b.replace(/#.*/,"")+"?ajax=1":b.replace(/#.*/,"")+"&ajax=1";a=c.extend(true,{url:b,success:c.ajaxSettings.success,type:k||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":
"about:blank"},a);b={};this.trigger("form-pre-serialize",[this,a,b]);if(b.veto)return m("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&a.beforeSerialize(this,a)===false)return m("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var i=a.traditional;if(i===void 0)i=c.ajaxSettings.traditional;var e,h=this.formToArray(a.semantic);if(a.data)a.extraData=a.data,e=c.param(a.data,i);if(a.beforeSubmit&&a.beforeSubmit(h,this,a)===false)return m("ajaxSubmit: submit aborted via beforeSubmit callback"),
this;this.trigger("form-submit-validate",[h,this,a,b]);if(b.veto)return m("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;b=c.param(h,i);e&&(b=b?b+"&"+e:e);a.type.toUpperCase()=="GET"?(a.url+=(a.url.indexOf("?")>=0?"&":"?")+b,a.data=null):a.data=b;var l=[];a.resetForm&&l.push(function(){j.resetForm()});a.clearForm&&l.push(function(){j.clearForm()});if(typeof a.target=="undefined")a.target=jQuery(this).attr("target");if(!a.dataType&&a.target){var t=a.success||function(){};l.push(function(b){var e=
a.replaceTarget?"replaceWith":"html";c(a.target)[e](b).each(t,arguments);c(a.target).jCore()})}else a.success&&l.push(a.success);a.success=function(b,c,e){a.target||(jQuery.loading(false),jQuery.loading(true,{html:b,text:"",max:5E3}));for(var f=a.context||a,h=0,i=l.length;h<i;h++)l[h].apply(f,[b,c,e||j,j])};e=c("input:file",this).length>0;b=j.attr("enctype")=="multipart/form-data"||j.attr("encoding")=="multipart/form-data";if(a.iframe!==false&&(e||a.iframe||b))a.closeKeepAlive?c.get(a.closeKeepAlive,
function(){f(h)}):f(h);else{if(c.browser.msie&&k=="get"&&typeof a.type==="undefined"&&(e=j[0].getAttribute("method"),typeof e==="string"))a.type=e;c.ajax(a)}this.trigger("form-submit-notify",[this,a]);return this};c.fn.ajaxForm=function(a){if(this.length===0){var f=this.selector,k=this.context;if(!c.isReady&&f)return m("DOM not ready, queuing ajaxForm"),c(function(){c(f,k).ajaxForm(a)}),this;m("terminating; zero elements found by selector"+(c.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",
function(b){b.isDefaultPrevented()||(b.preventDefault(),c(this).ajaxSubmit(a))}).bind("click.form-plugin",function(a){var f=a.target,i=c(f);if(!i.is(":submit,input:image")){f=i.closest(":submit");if(f.length==0)return;f=f[0]}var e=this;e.clk=f;if(f.type=="image")a.offsetX!=void 0?(e.clk_x=a.offsetX,e.clk_y=a.offsetY):typeof c.fn.offset=="function"?(i=i.offset(),e.clk_x=a.pageX-i.left,e.clk_y=a.pageY-i.top):(e.clk_x=a.pageX-f.offsetLeft,e.clk_y=a.pageY-f.offsetTop);setTimeout(function(){e.clk=e.clk_x=
e.clk_y=null},100)})};c.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};c.fn.formToArray=function(a){var f=[];if(this.length===0)return f;var k=this[0],b=a?k.getElementsByTagName("*"):k.elements;if(!b)return f;var j,i,e,h,l,m;for(j=0,l=b.length;j<l;j++)if(i=b[j],e=i.name)if(a&&k.clk&&i.type=="image")!i.disabled&&k.clk==i&&(f.push({name:e,value:c(i).val()}),f.push({name:e+".x",value:k.clk_x},{name:e+".y",value:k.clk_y}));else if((h=c.fieldValue(i,true))&&h.constructor==
Array)for(i=0,m=h.length;i<m;i++)f.push({name:e,value:h[i]});else h!==null&&typeof h!="undefined"&&f.push({name:e,value:h});if(!a&&k.clk&&(a=c(k.clk),b=a[0],(e=b.name)&&!b.disabled&&b.type=="image"))f.push({name:e,value:a.val()}),f.push({name:e+".x",value:k.clk_x},{name:e+".y",value:k.clk_y});return f};c.fn.formSerialize=function(a){return c.param(this.formToArray(a))};c.fn.fieldSerialize=function(a){var f=[];this.each(function(){var k=this.name;if(k){var b=c.fieldValue(this,a);if(b&&b.constructor==
Array)for(var j=0,i=b.length;j<i;j++)f.push({name:k,value:b[j]});else b!==null&&typeof b!="undefined"&&f.push({name:this.name,value:b})}});return c.param(f)};c.fn.fieldValue=function(a){for(var f=[],k=0,b=this.length;k<b;k++){var j=c.fieldValue(this[k],a);j===null||typeof j=="undefined"||j.constructor==Array&&!j.length||(j.constructor==Array?c.merge(f,j):f.push(j))}return f};c.fieldValue=function(a,f){var k=a.name,b=a.type,j=a.tagName.toLowerCase();f===void 0&&(f=true);if(f&&(!k||a.disabled||b=="reset"||
b=="button"||(b=="checkbox"||b=="radio")&&!a.checked||(b=="submit"||b=="image")&&a.form&&a.form.clk!=a||j=="select"&&a.selectedIndex==-1))return null;if(j=="select"){var i=a.selectedIndex;if(i<0)return null;for(var k=[],j=a.options,e=(b=b=="select-one")?i+1:j.length,i=b?i:0;i<e;i++){var h=j[i];if(h.selected){var l=h.value;l||(l=h.attributes&&h.attributes.value&&!h.attributes.value.specified?h.text:h.value);if(b)return l;k.push(l)}}return k}return c(a).val()};c.fn.clearForm=function(){return this.each(function(){c("input,select,textarea",
this).clearFields()})};c.fn.clearFields=c.fn.clearInputs=function(){var a=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var c=this.type,k=this.tagName.toLowerCase();if(a.test(c)||k=="textarea")this.value="";else if(c=="checkbox"||c=="radio")this.checked=false;else if(k=="select")this.selectedIndex=-1})};c.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&
this.reset()})};c.fn.enable=function(a){a===void 0&&(a=true);return this.each(function(){this.disabled=!a})};c.fn.selected=function(a){a===void 0&&(a=true);return this.each(function(){var f=this.type;if(f=="checkbox"||f=="radio")this.checked=a;else if(this.tagName.toLowerCase()=="option")f=c(this).parent("select"),a&&f[0]&&f[0].type=="select-one"&&f.find("option").selected(false),this.selected=a})};c.fn.ajaxSubmit.debug=false})(jQuery);
